hellonew[[n]]$Degree = as.numeric(hellonew[[n]]$Degree)
head(hellonew[[1]])
hi = factor(1983:2014)#
hello = list()#
hello2 = list()#
hello3 = list()#
hellonew = list()#
mean = list()#
countrynames = sort(rownames(U[[32]]))#
#
n2 = 1#
for 	(n in 1:23){#
	hello[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	mean[[n]] = matrix(NA, nrow = 0, ncol = 2)#
	for (d in 1:32){#
	hello[[n]]  = rbind(hello[[n]], cbind(UN$Degree[[d]][491:500,n2], rep(hi[d], length(UN$Degree[[d]][491:500,n2])), rep("RE", length(UN$Degree[[d]][491:500,n2]))))#
	diag(Y[d,, ])= 0#
	Y[d, which(avail1[d,]==0), ] = 0#
	Y[d, , which(avail1[d,]==0)] = 0#
	mean[[n]] = rbind(mean[[n]], c(rowSums(Y[d,,], na.rm=TRUE)[n2], hi[d]))#
}#
colnames(hello[[n]]) = c("Degree", "Year", "Model")#
hello[[n]] = as.data.frame(hello[[n]])#
hello[[n]]$Year = factor(sort(as.numeric(hello[[n]]$Year)), labels = c(1983:2014))#
#
	hello2[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello2[[n]]  = rbind(hello2[[n]], cbind(UN1$Degree[[d]][491:500,n2], rep(hi[d], length(UN1$Degree[[d]][491:500,n2])), rep("ADD", length(UN1$Degree[[d]][491:500,n2]))))#
	}#
colnames(hello2[[n]]) = c("Degree", "Year", "Model")#
hello2[[n]] = as.data.frame(hello2[[n]])#
hello2[[n]]$Year = factor(sort(as.numeric(hello2[[n]]$Year)), labels = c(1983:2014))#
#
hello3[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello3[[n]]  = rbind(hello3[[n]], cbind(UN2$Degree[[d]][491:500,n2], rep(hi[d], length(UN2$Degree[[d]][491:500,n2])), rep("NO", length(UN2$Degree[[d]][491:500,n2]))))#
	}#
colnames(hello3[[n]]) = c("Degree", "Year", "Model")#
hello3[[n]] = as.data.frame(hello3[[n]])#
hello3[[n]]$Year = factor(sort(as.numeric(hello3[[n]]$Year)), labels = c(1983:2014))#
hellonew[[n]] = as.data.frame(rbind(hello[[n]], hello2[[n]], hello3[[n]]))#
colnames(mean[[n]]) =  c("Degree", "Year")#
mean[[n]] = as.data.frame(mean[[n]])#
n2 = n2 + 1#
}#
#
countryname = sort(rownames(U[[32]]))#
countryname2 = (rownames(U[[32]]))#
ggplotColours <- function(n = 6, h = c(0, 360) + 15){#
  if ((diff(h) %% 360) < 1) h[2] <- h[2] - 360/n#
  hcl(h = (seq(h[1], h[2], length = n)), c = 100, l = 65)#
}#
#
countrynames = ggplotColours(23)#
p10 = list()#
n2 = 1
head(hellonew[[1]])
as.numeric(hellonew[[n]]$Degree)
hellonew[[n]]$Degree
as.numeric(as.character(hellonew[[n]]$Degree))
hellonew[[n]]$Degree = as.numeric(as.character(hellonew[[n]]$Degree))
countrynames = ggplotColours(23)#
p10 = list()#
n2 = 1#
for (n in 1:23){#
	hellonew[[n]]$Degree = as.numeric(as.character(hellonew[[n]]$Degree))#
p10[[n]] = ggplot(hellonew[[n]], aes(x = Year, y = Degree, colour = as.factor(Model))) + geom_boxplot(position = position_dodge()) + theme_bw() + scale_colour_discrete(name = countrynames[n]) + geom_line(data = mean[[n]], colour = countrynames[n2])#
#annotate("text", 30, 10, size = 5, label = countryname2[n], colour = countrynames[n])#
n2 = n2 + 1#
#
mname = paste0(countryname2[n], n, ".png")#
print(p10[[n]])#
ggsave(filename = mname, width = 10, height = 6)#
}
countryname = sort(rownames(U[[32]]))#
countryname2 = (rownames(U[[32]]))#
ggplotColours <- function(n = 6, h = c(0, 360) + 15){#
  if ((diff(h) %% 360) < 1) h[2] <- h[2] - 360/n#
  hcl(h = (seq(h[1], h[2], length = n)), c = 100, l = 65)#
}#
#
countrynames = ggplotColours(23)
countrynames
countrname
countryname
## side by side #
hi = factor(1983:2014)#
hello = list()#
hello2 = list()#
hello3 = list()#
hellonew = list()#
mean = list()#
countrynames = sort(rownames(U[[32]]))#
#
n2 = 1#
for 	(n in 1:23){#
	hello[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	mean[[n]] = matrix(NA, nrow = 0, ncol = 2)#
	for (d in 1:32){#
	hello[[n]]  = rbind(hello[[n]], cbind(UN$Degree[[d]][,n2], rep(hi[d], length(UN$Degree[[d]][,n2])), rep("RE", length(UN$Degree[[d]][,n2]))))#
	diag(Y[d,, ])= 0#
	Y[d, which(avail1[d,]==0), ] = 0#
	Y[d, , which(avail1[d,]==0)] = 0#
	mean[[n]] = rbind(mean[[n]], c(rowSums(Y[d,,], na.rm=TRUE)[n2], hi[d]))#
}#
colnames(hello[[n]]) = c("Degree", "Year", "Model")#
hello[[n]] = as.data.frame(hello[[n]])#
hello[[n]]$Year = factor(sort(as.numeric(hello[[n]]$Year)), labels = c(1983:2014))#
#
	hello2[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello2[[n]]  = rbind(hello2[[n]], cbind(UN1$Degree[[d]][,n2], rep(hi[d], length(UN1$Degree[[d]][,n2])), rep("ADD", length(UN1$Degree[[d]][,n2]))))#
	}#
colnames(hello2[[n]]) = c("Degree", "Year", "Model")#
hello2[[n]] = as.data.frame(hello2[[n]])#
hello2[[n]]$Year = factor(sort(as.numeric(hello2[[n]]$Year)), labels = c(1983:2014))#
#
hello3[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello3[[n]]  = rbind(hello3[[n]], cbind(UN2$Degree[[d]][,n2], rep(hi[d], length(UN2$Degree[[d]][,n2])), rep("NO", length(UN2$Degree[[d]][,n2]))))#
	}#
colnames(hello3[[n]]) = c("Degree", "Year", "Model")#
hello3[[n]] = as.data.frame(hello3[[n]])#
hello3[[n]]$Year = factor(sort(as.numeric(hello3[[n]]$Year)), labels = c(1983:2014))#
hellonew[[n]] = as.data.frame(rbind(hello[[n]], hello2[[n]], hello3[[n]]))#
colnames(mean[[n]]) =  c("Degree", "Year")#
mean[[n]] = as.data.frame(mean[[n]])#
n2 = n2 + 1#
}#
#
countryname = sort(rownames(U[[32]]))#
countryname2 = (rownames(U[[32]]))#
ggplotColours <- function(n = 6, h = c(0, 360) + 15){#
  if ((diff(h) %% 360) < 1) h[2] <- h[2] - 360/n#
  hcl(h = (seq(h[1], h[2], length = n)), c = 100, l = 65)#
}#
#
countrynames = ggplotColours(23)#
p10 = list()#
n2 = 1#
for (n in 1:23){#
	hellonew[[n]]$Degree = as.numeric(as.character(hellonew[[n]]$Degree))#
p10[[n]] = ggplot(hellonew[[n]], aes(x = Year, y = Degree, colour = as.factor(Model))) + geom_boxplot(position = position_dodge()) + theme_bw() + scale_colour_discrete(name = countryname[n]) + geom_line(data = mean[[n]], colour = "black", size = 3)#
#annotate("text", 30, 10, size = 5, label = countryname2[n], colour = countrynames[n])#
n2 = n2 + 1#
#
mname = paste0(countryname2[n], n, ".png")#
print(p10[[n]])#
ggsave(filename = mname, width = 10, height = 6)#
}
countrynames = ggplotColours(23)#
p10 = list()#
n2 = 1#
for (n in 1:23){#
	hellonew[[n]]$Degree = as.numeric(as.character(hellonew[[n]]$Degree))#
p10[[n]] = ggplot(hellonew[[n]], aes(x = Year, y = Degree, colour = as.factor(Model))) + geom_boxplot(outlier.size = 0.5, position = position_dodge()) + theme_bw() + scale_colour_discrete(name = countryname[n]) + geom_line(data = mean[[n]], colour = "grey", size = 2)#
#annotate("text", 30, 10, size = 5, label = countryname2[n], colour = countrynames[n])#
n2 = n2 + 1#
#
mname = paste0(countryname2[n], n, ".png")#
print(p10[[n]])#
ggsave(filename = mname, width = 10, height = 6)#
}
countrynames = ggplotColours(23)#
p10 = list()#
n2 = 1#
for (n in 1:23){#
	hellonew[[n]]$Degree = as.numeric(as.character(hellonew[[n]]$Degree))#
p10[[n]] = ggplot(hellonew[[n]], aes(x = Year, y = Degree, colour = as.factor(Model))) + geom_boxplot(outlier.size = 0.5, position = position_dodge()) + theme_bw() + scale_colour_discrete(name = countryname[n]) + geom_line(data = mean[[n]], colour = "grey60", size = 1)#
#annotate("text", 30, 10, size = 5, label = countryname2[n], colour = countrynames[n])#
n2 = n2 + 1#
#
mname = paste0(countryname2[n], n, ".png")#
print(p10[[n]])#
ggsave(filename = mname, width = 10, height = 6)#
}
## side by side #
hi = factor(1983:2014)#
hello = list()#
hello2 = list()#
hello3 = list()#
hellonew = list()#
mean = list()#
countrynames = sort(rownames(U[[32]]))#
#
n2 = 1#
for 	(n in 1:23){#
	hello[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	mean[[n]] = matrix(NA, nrow = 0, ncol = 2)#
	for (d in 1:32){#
	hello[[n]]  = rbind(hello[[n]], cbind(UN$Degree[[d]][,n2], rep(hi[d], length(UN$Degree[[d]][,n2])), rep("AME", length(UN$Degree[[d]][,n2]))))#
	diag(Y[d,, ])= 0#
	Y[d, which(avail1[d,]==0), ] = 0#
	Y[d, , which(avail1[d,]==0)] = 0#
	mean[[n]] = rbind(mean[[n]], c(rowSums(Y[d,,], na.rm=TRUE)[n2], hi[d]))#
}#
colnames(hello[[n]]) = c("Degree", "Year", "Model")#
hello[[n]] = as.data.frame(hello[[n]])#
hello[[n]]$Year = factor(sort(as.numeric(hello[[n]]$Year)), labels = c(1983:2014))#
#
	hello2[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello2[[n]]  = rbind(hello2[[n]], cbind(UN1$Degree[[d]][,n2], rep(hi[d], length(UN1$Degree[[d]][,n2])), rep("AE", length(UN1$Degree[[d]][,n2]))))#
	}#
colnames(hello2[[n]]) = c("Degree", "Year", "Model")#
hello2[[n]] = as.data.frame(hello2[[n]])#
hello2[[n]]$Year = factor(sort(as.numeric(hello2[[n]]$Year)), labels = c(1983:2014))#
#
hello3[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello3[[n]]  = rbind(hello3[[n]], cbind(UN2$Degree[[d]][,n2], rep(hi[d], length(UN2$Degree[[d]][,n2])), rep("NO", length(UN2$Degree[[d]][,n2]))))#
	}#
colnames(hello3[[n]]) = c("Degree", "Year", "Model")#
hello3[[n]] = as.data.frame(hello3[[n]])#
hello3[[n]]$Year = factor(sort(as.numeric(hello3[[n]]$Year)), labels = c(1983:2014))#
hellonew[[n]] = as.data.frame(rbind(hello[[n]], hello2[[n]], hello3[[n]]))#
colnames(mean[[n]]) =  c("Degree", "Year")#
mean[[n]] = as.data.frame(mean[[n]])#
n2 = n2 + 1#
}#
#
countryname = sort(rownames(U[[32]]))#
countryname2 = (rownames(U[[32]]))#
ggplotColours <- function(n = 6, h = c(0, 360) + 15){#
  if ((diff(h) %% 360) < 1) h[2] <- h[2] - 360/n#
  hcl(h = (seq(h[1], h[2], length = n)), c = 100, l = 65)#
}#
#
countrynames = ggplotColours(23)#
p10 = list()#
n2 = 1#
for (n in 1:23){#
	hellonew[[n]]$Degree = as.numeric(as.character(hellonew[[n]]$Degree))#
p10[[n]] = ggplot(hellonew[[n]], aes(x = Year, y = Degree, colour = as.factor(Model))) + geom_boxplot(outlier.size = 0.5, position = position_dodge()) + theme_bw() + scale_colour_discrete(name = countryname[n]) + geom_line(data = mean[[n]], colour = "grey60", size = 1)#
#annotate("text", 30, 10, size = 5, label = countryname2[n], colour = countrynames[n])#
n2 = n2 + 1#
#
mname = paste0(countryname2[n], n, ".png")#
print(p10[[n]])#
ggsave(filename = mname, width = 10, height = 6)#
}
load("/Users/bomin8319/Desktop/DLFM/UNfit/DLFM_UNfull.RData")#
UN = UN#
#
attach(UN)#
library(ggplot2)#
library(MCMCpack)#
library(reshape2)#
library(gridExtra)#
library(ggrepel)#
library(RColorBrewer)#
years = c(1983:2014)#
load("/Users/bomin8319/Desktop/DLFM/UNfit/UNdatafull.RData")#
attach(UNdatafull)#
library(FastGP)#
library(mvtnorm)#
library(fields)#
library(reshape)#
library(MCMCpack)#
library(expm)#
library(igraph)#
#library(devtools)#
#install_github('bomin8319/DLFM/pkg')#
library(DLFM)
beta = lapply(1:32, function(t){summary(mcmc(BETA[[t]][101:400,]))[[2]]})#
betas = list()#
for (i in 1:6) {betas[[i]] = sapply(1:32, function(t){beta[[t]][i,]})}
betas
number_ticks <- function(n) {function(limits) pretty(limits, n)}#
plots = list()#
i= 1#
years = c(1983:2014)#
data = data.frame(cbind(years,t(betas[[i]])))#
 colnames(data)[4] = "beta"#
 f = ggplot(data, aes(x = years))#
f + geom_line(aes(y = beta), colour="blue") + geom_ribbon(aes(ymin = X2.5., ymax = X97.5.), alpha = 0.1) + scale_x_continuous(breaks=number_ticks(8))+ylab("Intercept") + theme_bw()#
#
color = c("red", "orange", "green", "purple", "pink")#
varname = c("log(distance)", "Polity", "Alliance", "Lower trade-to-GDP ratio", "Common Language")#
for (i in 2:6){#
years = c(1983:2014)#
data = data.frame(cbind(years,t(betas[[i]])))#
 colnames(data)[4] = "beta"#
 f = ggplot(data, aes(x = years))#
 plots[[i]] <- f + geom_line(aes(y = beta), colour=color[i-1]) + geom_ribbon(aes(ymin = X2.5., ymax = X97.5.), alpha = 0.1) + ylab(varname[i-1]) + scale_x_continuous(breaks=number_ticks(8)) + geom_hline(yintercept = 0) + theme_bw()#
#
 }
plosts
plots
marrangeGrob(plots[2:6], nrow = 2, ncol = 3, top = NULL)
X[1,,,2]
dimnames(X)
corr
cor(c(X[,,,2]), c(X[,,,3]), use="complete")
?cor
cor(c(X[,,,2]), c(X[,,,3]), use="complete.obs")
c(X[,,,3])
cor(c(X[,,,2]), c(X[,,,3]), use="complete.obs")
cor(c(X[1,,,2]), c(X[1,,,3]), use="complete.obs")
cor(c(upper.tri(X[1,,,2])), c(upper.tri(X[1,,,3])), use="complete.obs")
c(upper.tri(X[1,,,2]))
cor(c(X[1,,,2][upper.tri(X[1,,,2])]), c(X[1,,,2][upper.tri(X[1,,,3])]), use="complete.obs")
c(X[1,,,2][upper.tri(X[1,,,2])])
cor(c(X[1,,,2][upper.tri(X[1,,,2])]), c(X[1,,,3][upper.tri(X[1,,,3])]), use="complete.obs")
cor(c(X[1,,,2][upper.tri(X[1,,,2])]), c(X[1,,,4][upper.tri(X[1,,,4])]), use="complete.obs")
cor(c(X[1,,,2][upper.tri(X[1,,,2])]), c(X[1,,,5][upper.tri(X[1,,,5])]), use="complete.obs")
cor(c(X[1,,,2][upper.tri(X[1,,,2])]), c(X[1,,,6][upper.tri(X[1,,,6])]), use="complete.obs")
marrangeGrob(plots[2:6], nrow = 2, ncol = 3, top = NULL)
number_ticks <- function(n) {function(limits) pretty(limits, n)}#
plots = list()#
i= 1#
years = c(1983:2014)#
data = data.frame(cbind(years,t(betas[[i]])))#
 colnames(data)[4] = "beta"#
 f = ggplot(data, aes(x = years))#
f + geom_line(aes(y = beta), colour="blue") + geom_ribbon(aes(ymin = X2.5., ymax = X97.5.), alpha = 0.1) + scale_x_continuous(breaks=number_ticks(8))+ylab("Intercept") + theme_bw()
dim(BETA[[1]])
beta = lapply(1:32, function(t){summary(mcmc(BETA[[t]][101:500,]))[[2]]})#
betas = list()#
for (i in 1:6) {betas[[i]] = sapply(1:32, function(t){beta[[t]][i,]})}#
#
number_ticks <- function(n) {function(limits) pretty(limits, n)}#
plots = list()#
i= 1#
years = c(1983:2014)#
data = data.frame(cbind(years,t(betas[[i]])))#
 colnames(data)[4] = "beta"#
 f = ggplot(data, aes(x = years))#
f + geom_line(aes(y = beta), colour="blue") + geom_ribbon(aes(ymin = X2.5., ymax = X97.5.), alpha = 0.1) + scale_x_continuous(breaks=number_ticks(8))+ylab("Intercept") + theme_bw()
color = c("red", "orange", "green", "purple", "pink")#
varname = c("log(distance)", "Polity", "Alliance", "Lower trade-to-GDP ratio", "Common Language")#
for (i in 2:6){#
years = c(1983:2014)#
data = data.frame(cbind(years,t(betas[[i]])))#
 colnames(data)[4] = "beta"#
 f = ggplot(data, aes(x = years))#
 plots[[i]] <- f + geom_line(aes(y = beta), colour=color[i-1]) + geom_ribbon(aes(ymin = X2.5., ymax = X97.5.), alpha = 0.1) + ylab(varname[i-1]) + scale_x_continuous(breaks=number_ticks(8)) + geom_hline(yintercept = 0) + theme_bw()#
#
 }#
#
marrangeGrob(plots[2:6], nrow = 2, ncol = 3, top = NULL)
Xstar = matrix(0, nrow = 23, ncol = 2)#
rownames(Xstar) = sort(rownames(U[[32]]))#
rownames(Xstar)[which(rownames(Xstar) == "GFR")] = "GMY"#
Xstar[23, ]= c(1,1)#
Xstar[15, ] = c(-1,-1)#
#Xstar[19, ] = c(0, -1)#
##Xstar[20, ] = c(0.5, 0.5)#
#Xstar[11, ] = c(1, 0)#
#Xstar[16,] =c(0.5, 1)#
plots= list()#
data2 = list()#
colors = sort(rownames(U[[32]]))#
colors[which(colors == "GFR")] = "GMY"#
for (t in 1:32) {#
UDmat = matrix(NA, 23, 2)#
rownames(UDmat) = colors#
rownames(U[[t]])[which(rownames(U[[t]]) == "GFR")] = "GMY"#
UDmat[which(rownames(UDmat) %in% rownames(U[[t]])),1] =  U[[t]][sort(rownames(U[[t]])),1] * D[[t]][1] #
UDmat[which(rownames(UDmat) %in% rownames(U[[t]])),2] =  U[[t]][sort(rownames(U[[t]])),2] * D[[t]][2] #
UDmat[which(rownames(UDmat) %in% rownames(U[[t]])), ] = procrustes(UDmat[which(rownames(UDmat) %in% rownames(U[[t]])),], Xstar[which(rownames(Xstar) %in% rownames(U[[t]])),])$X.new#
UDmat = UDmat - UDmat[which(rownames(UDmat) =="USA"),]#
data2[[t]] = data.frame(UDmat)#
colnames(data2[[t]])[1:2] = c("r1", "r2")#
Xstar = UDmat#
Xstar[is.na(Xstar)] = rep(0, 2)#
}#
rangex = summary(unlist(sapply(1:32, function(t){data2[[t]][,1][!is.na(data2[[t]][,1])]})))#
rangey = summary(unlist(sapply(1:32, function(t){data2[[t]][,2][!is.na(data2[[t]][,2])]})))#
#
for (t in 1:32) {#
colors.t = colors[which(colors %in% rownames(U[[t]]))]#
p <- ggplot(data2[[t]], aes(x = r1, y = r2, colour = colors, label = rownames(data2[[t]])))#
#
plots[[t]] = p+ geom_text(size = 10, show.legend = F)+ ggtitle(years[t]) + theme_bw()+ theme(plot.title = element_text(hjust = 0.5)) + xlim(rangex[1], rangex[6]) + ylim(rangey[1], rangey[6]) #
mname = paste0("plot", t, ".png")#
print(plots[[t]])
}
rownames(U[[32]])
Xstar = matrix(0, nrow = 74, ncol = 2)#
rownames(Xstar) = sort(rownames(U[[32]]))#
rownames(Xstar)[which(rownames(Xstar) == "GFR")] = "GMY"#
Xstar[23, ]= c(1,1)#
Xstar[15, ] = c(-1,-1)#
#Xstar[19, ] = c(0, -1)#
##Xstar[20, ] = c(0.5, 0.5)#
#Xstar[11, ] = c(1, 0)#
#Xstar[16,] =c(0.5, 1)#
plots= list()#
data2 = list()#
colors = sort(rownames(U[[32]]))#
colors[which(colors == "GFR")] = "GMY"#
for (t in 1:32) {#
UDmat = matrix(NA, 23, 2)#
rownames(UDmat) = colors#
rownames(U[[t]])[which(rownames(U[[t]]) == "GFR")] = "GMY"#
UDmat[which(rownames(UDmat) %in% rownames(U[[t]])),1] =  U[[t]][sort(rownames(U[[t]])),1] * D[[t]][1] #
UDmat[which(rownames(UDmat) %in% rownames(U[[t]])),2] =  U[[t]][sort(rownames(U[[t]])),2] * D[[t]][2] #
UDmat[which(rownames(UDmat) %in% rownames(U[[t]])), ] = procrustes(UDmat[which(rownames(UDmat) %in% rownames(U[[t]])),], Xstar[which(rownames(Xstar) %in% rownames(U[[t]])),])$X.new#
UDmat = UDmat - UDmat[which(rownames(UDmat) =="USA"),]#
data2[[t]] = data.frame(UDmat)#
colnames(data2[[t]])[1:2] = c("r1", "r2")#
Xstar = UDmat#
Xstar[is.na(Xstar)] = rep(0, 2)#
}#
rangex = summary(unlist(sapply(1:32, function(t){data2[[t]][,1][!is.na(data2[[t]][,1])]})))#
rangey = summary(unlist(sapply(1:32, function(t){data2[[t]][,2][!is.na(data2[[t]][,2])]})))#
#
for (t in 1:32) {#
colors.t = colors[which(colors %in% rownames(U[[t]]))]#
p <- ggplot(data2[[t]], aes(x = r1, y = r2, colour = colors, label = rownames(data2[[t]])))#
#
plots[[t]] = p+ geom_text(size = 10, show.legend = F)+ ggtitle(years[t]) + theme_bw()+ theme(plot.title = element_text(hjust = 0.5)) + xlim(rangex[1], rangex[6]) + ylim(rangey[1], rangey[6]) #
mname = paste0("plot", t, ".png")#
print(plots[[t]])
}
Xstar = matrix(0, nrow = 74, ncol = 2)#
rownames(Xstar) = sort(rownames(U[[32]]))#
rownames(Xstar)[which(rownames(Xstar) == "GFR")] = "GMY"#
Xstar[23, ]= c(1,1)#
Xstar[15, ] = c(-1,-1)#
#Xstar[19, ] = c(0, -1)#
##Xstar[20, ] = c(0.5, 0.5)#
#Xstar[11, ] = c(1, 0)#
#Xstar[16,] =c(0.5, 1)#
plots= list()#
data2 = list()#
colors = sort(rownames(U[[32]]))#
colors[which(colors == "GFR")] = "GMY"#
for (t in 1:32) {#
UDmat = matrix(NA, 74, 2)#
rownames(UDmat) = colors#
rownames(U[[t]])[which(rownames(U[[t]]) == "GFR")] = "GMY"#
UDmat[which(rownames(UDmat) %in% rownames(U[[t]])),1] =  U[[t]][sort(rownames(U[[t]])),1] * D[[t]][1] #
UDmat[which(rownames(UDmat) %in% rownames(U[[t]])),2] =  U[[t]][sort(rownames(U[[t]])),2] * D[[t]][2] #
UDmat[which(rownames(UDmat) %in% rownames(U[[t]])), ] = procrustes(UDmat[which(rownames(UDmat) %in% rownames(U[[t]])),], Xstar[which(rownames(Xstar) %in% rownames(U[[t]])),])$X.new#
UDmat = UDmat - UDmat[which(rownames(UDmat) =="USA"),]#
data2[[t]] = data.frame(UDmat)#
colnames(data2[[t]])[1:2] = c("r1", "r2")#
Xstar = UDmat#
Xstar[is.na(Xstar)] = rep(0, 2)#
}#
rangex = summary(unlist(sapply(1:32, function(t){data2[[t]][,1][!is.na(data2[[t]][,1])]})))#
rangey = summary(unlist(sapply(1:32, function(t){data2[[t]][,2][!is.na(data2[[t]][,2])]})))#
#
for (t in 1:32) {#
colors.t = colors[which(colors %in% rownames(U[[t]]))]#
p <- ggplot(data2[[t]], aes(x = r1, y = r2, colour = colors, label = rownames(data2[[t]])))#
#
plots[[t]] = p+ geom_text(size = 10, show.legend = F)+ ggtitle(years[t]) + theme_bw()+ theme(plot.title = element_text(hjust = 0.5)) + xlim(rangex[1], rangex[6]) + ylim(rangey[1], rangey[6]) #
mname = paste0("plot", t, ".png")#
print(plots[[t]])
{}
Xstar = matrix(0, nrow = 74, ncol = 2)#
rownames(Xstar) = sort(rownames(U[[32]]))#
rownames(Xstar)[which(rownames(Xstar) == "GFR")] = "GMY"#
Xstar[23, ]= c(1,1)#
Xstar[15, ] = c(-1,-1)#
#Xstar[19, ] = c(0, -1)#
##Xstar[20, ] = c(0.5, 0.5)#
#Xstar[11, ] = c(1, 0)#
#Xstar[16,] =c(0.5, 1)#
plots= list()#
data2 = list()#
colors = sort(rownames(U[[32]]))#
colors[which(colors == "GFR")] = "GMY"#
for (t in 1:32) {#
UDmat = matrix(NA, 74, 2)#
rownames(UDmat) = colors#
rownames(U[[t]])[which(rownames(U[[t]]) == "GFR")] = "GMY"#
UDmat[which(rownames(UDmat) %in% rownames(U[[t]])),1] =  U[[t]][sort(rownames(U[[t]])),1] * D[[t]][1] #
UDmat[which(rownames(UDmat) %in% rownames(U[[t]])),2] =  U[[t]][sort(rownames(U[[t]])),2] * D[[t]][2] #
UDmat[which(rownames(UDmat) %in% rownames(U[[t]])), ] = procrustes(UDmat[which(rownames(UDmat) %in% rownames(U[[t]])),], Xstar[which(rownames(Xstar) %in% rownames(U[[t]])),])$X.new#
UDmat = UDmat - UDmat[which(rownames(UDmat) =="USA"),]#
data2[[t]] = data.frame(UDmat)#
colnames(data2[[t]])[1:2] = c("r1", "r2")#
Xstar = UDmat#
Xstar[is.na(Xstar)] = rep(0, 2)#
}#
rangex = summary(unlist(sapply(1:32, function(t){data2[[t]][,1][!is.na(data2[[t]][,1])]})))#
rangey = summary(unlist(sapply(1:32, function(t){data2[[t]][,2][!is.na(data2[[t]][,2])]})))#
#
for (t in 1:32) {#
colors.t = colors[which(colors %in% rownames(U[[t]]))]#
p <- ggplot(data2[[t]], aes(x = r1, y = r2, colour = colors, label = rownames(data2[[t]])))#
#
plots[[t]] = p+ geom_text(size = 10, show.legend = F)+ ggtitle(years[t]) + theme_bw()+ theme(plot.title = element_text(hjust = 0.5)) + xlim(rangex[1], rangex[6]) + ylim(rangey[1], rangey[6]) #
mname = paste0("plot", t, ".png")#
print(plots[[t]])
}
warnings()
marrangeGrob(plots[1:16], nrow = 4, ncol = 4, top = NULL)
colors = sort(rownames(U[[32]]))#
colors[which(colors == "GFR")] = "GMY"#
	thetanew = t(sapply(1:32, function(t){colMeans(UN$theta[[t]])}))#
	orders = sapply(1:74, function(n){which(colors[n]== rownames(U[[32]]))})#
	thetanew = thetanew[,orders]#
	data3 = data.frame(years = years, theta = thetanew)#
	colnames(data3)[-1] = colors#
	data3new = melt(data3, id = "years")#
	colnames(data3new)[3] = "theta"#
	f <- ggplot(data3new, aes(years, theta, colour = variable, label = variable))#
	f + geom_line() + scale_x_continuous(breaks=number_ticks(8)) + scale_colour_discrete(name = "countries") + theme_bw()#
	#+ annotate("text", x = rep(2014, 23), y = data3new[data3new$year==2014,3], label = colors, fill = factor(1:23))
#posterior predictive check#
#
hi = factor(1983:2014)#
#
hello = list()#
#
mean = list()#
#
countrynames = sort(rownames(U[[32]]))#
n2 = 1#
#
for 	(n in 1:74){#
#
	hello[[n]] = matrix(NA, nrow = 0, ncol = 2)#
#
	mean[[n]] = matrix(NA, nrow = 0, ncol = 2)#
#
	for (d in 1:32){#
#
	hello[[n]]  = rbind(hello[[n]], cbind(UN$Degree[[d]][,n2], rep(hi[d], length(UN$Degree[[d]][,n2]))))#
#
	diag(Y[d,, ])= 0#
#
	Y[d, which(avail1[d,]==0), ] = 0#
#
	Y[d, , which(avail1[d,]==0)] = 0#
#
	mean[[n]] = rbind(mean[[n]], c(rowSums(Y[d,,], na.rm=TRUE)[n2], hi[d]))#
#
}#
#
colnames(hello[[n]]) = c("Degree", "Year")#
#
hello[[n]] = as.data.frame(hello[[n]])#
#
colnames(mean[[n]]) =  c("Degree", "Year")#
#
mean[[n]] = as.data.frame(mean[[n]])#
#
hello[[n]]$Year = factor(hello[[n]]$Year, labels = c(1983:2014))#
#
n2 = n2 + 1#
#
}
countryname = sort(rownames(U[[32]]))#
#
countryname2 = (rownames(U[[32]]))#
#
ggplotColours <- function(n = 6, h = c(0, 360) + 15){#
#
  if ((diff(h) %% 360) < 1) h[2] <- h[2] - 360/n#
#
  hcl(h = (seq(h[1], h[2], length = n)), c = 100, l = 65)#
#
}#
countrynames = ggplotColours(74)#
#
p10 = list()#
#
n2 = 1#
#
for (n in 1:23){#
#
p10[[n]] = ggplot(hello[[n]], aes(x = Year, y = Degree)) + geom_boxplot(colour = countrynames[n2]) + theme_bw() + scale_colour_discrete(name = countrynames[n]) + geom_line(data = mean[[n]], colour = countrynames[n2])#
#
#annotate("text", 30, 10, size = 5, label = countryname2[n], colour = countrynames[n])#
#
n2 = n2 + 1
mname = paste0(countryname2[n], n, ".png")#
#
print(p10[[n]])
}
# 83 country version#
# not existing countries -> all missing values imputed using model (biased)#
avail1 = matrix(1, 32, 74)#
avail1[1:8, c(71, 36)] =0 #North and South Korea did not joined UN voting until 1990#
avail1[1:10, 72] = 0 #GRG no voted until 1992#
avail1[1:9, 73] = 0 #RUS X variables not existed until 1991#
avail1[1:9, 74] = 0 #UKR not existed until 1991#
avail1[13:21, 29] = 0 #IRQ under sanction
pp = list()#
for (tp in 1:32) {#
	diag(Y[tp,,]) = 0#
	Y[tp, which(avail1[tp, ]==0), ] = 0#
	Y[tp, , which(avail1[tp, ]==0)] = 0#
	data = sapply(1:500, function(r){table(floor(UN$Degree[[tp]][r,]))})#
	datamat = matrix(0, 500, 20)#
	colnames(datamat) = 0:19#
	for (i in 1:500) {#
		datamat[i, which(colnames(datamat) %in% names(data[[i]]))] = data[[i]] / sum(data[[i]])#
	}#
	datamat2 = data.frame(Proportion = c(datamat), Degree = factor(c(sapply(0:19, function(k){rep(k, 500)}))))	#
	observedpp = table(floor(rowSums(Y[tp,,]))) / sum(table(floor(rowSums(Y[tp,,]))))#
	pvec = rep(0, 20)#
	names(pvec) = 0:19#
	pvec[which(names(pvec) %in% names(observedpp))] = observedpp#
	observed = data.frame(Proportion = pvec, Degree = as.numeric(1:20))#
	pp[[tp]] = ggplot(datamat2, aes(x = Degree, y = Proportion)) + geom_boxplot(outlier.size = 0.5) + theme_bw() + geom_line(data = observed)+ggtitle(years[tp])#
}#
marrangeGrob(pp[1:16], nrow = 4, ncol = 4, top = NULL)
##Posterior predictive of degree#
pp = list()#
for (tp in 1:32) {#
	diag(Y[tp,,]) = 0#
	Y[tp, which(avail1[tp, ]==0), ] = 0#
	Y[tp, , which(avail1[tp, ]==0)] = 0#
	data = sapply(1:500, function(r){table(floor(UN$Degree[[tp]][r,]))})#
	datamat = matrix(0, 500, 20)#
	colnames(datamat) = 0:19#
	for (i in 1:500) {#
		datamat[i, which(colnames(datamat) %in% names(data[[i]]))] = data[[i]] / sum(data[[i]])#
	}#
	datamat2 = data.frame(Proportion = c(datamat), Degree = factor(c(sapply(0:19, function(k){rep(k, 500)}))))	#
	observedpp = table(floor(rowSums(Y[tp,,]))) / sum(table(floor(rowSums(Y[tp,,]))))#
	pvec = rep(0, 20)#
	names(pvec) = 0:19#
	pvec[which(names(pvec) %in% names(observedpp))] = observedpp#
	observed = data.frame(Proportion = pvec, Degree = as.numeric(1:20))#
	pp[[tp]] = ggplot(datamat2, aes(x = Degree, y = Proportion)) + geom_boxplot(outlier.size = 0.5) + theme_bw() + geom_line(data = observed)+ggtitle(years[tp])#
}
load("/Users/bomin8319/Desktop/DLFM/UNfit/UNdatafull.RData")#
attach(UNdatafull)#
library(FastGP)#
library(mvtnorm)#
library(fields)#
library(reshape)#
library(MCMCpack)#
library(expm)#
library(igraph)#
#library(devtools)#
#install_github('bomin8319/DLFM/pkg')#
library(DLFM)#
reduced <-which(dimnames(Y)[[2]] %in% c("USA", "CHN", "IND", "UKG", "FRN", "GFR", "TUR", "JPN", "ISR", "SYR", "LEB", "SUD", "IRN", "AUL", "PAK", "EGY", "AFG", "PRK", "RUS", "GRG", "UKR", "ROK", "IRQ"))#
#
#reduced <-which(dimnames(Y)[[2]] %in% c("USA", "CHN", "IND", "UKG", "FRN", "GFR", "TUR", "JPN", "ISR", "SYR", "LEB", "SUD", "IRN", "AUL", "PAK", "EGY"))#
Y = Y[, reduced, reduced]#
X = X[, reduced, reduced, 1:5]#
#
for(tp in 1:32){#
	diag(X[tp,,,2]) = 0#
}
Y[1,,]
# not existing countries -> all missing values imputed using model (biased)#
avail1 = matrix(1, 32, 23)#
avail1[1:8, c(12, 20)] =0 #North and South Korea did not joined UN voting until 1990#
avail1[1:10, 21] = 0 #GRG no voted until 1992#
avail1[1:9, 22] = 0 #RUS X variables not existed until 1991#
avail1[1:9, 23] = 0 #UKR not existed until 1991#
avail1[13:21, 9] = 0 #IRQ under sanction
Y[1,,]
avail1
tp = 1
which(avail1[tp, ]==0)
for(tp in 1:32){#
	diag(X[tp,,,2]) = 0#
	Y[tp, which(avail1[tp, ]==0),] = 0#
	Y[tp, , which(avail1[tp, ]==0)] = 0#
}
Y[1,,]
Y[2,,]
for(tp in 1:32){#
	diag(X[tp,,,2]) = 0#
	Y[tp, which(avail1[tp, ]==0),] = 0#
	Y[tp, , which(avail1[tp, ]==0)] = 0#
	diag(Y[tp,,])= 0#
}
Y[1,,]
for(tp in 1:32){#
	diag(X[tp,,,2]) = 0#
	Y[tp, which(avail1[tp, ]==0),] = NA#
	Y[tp, , which(avail1[tp, ]==0)] = NA#
	diag(Y[tp,,])= NA#
}
Y[1,,]
sapply(1:32, function(t){mean(Y[tp,,][upper.tri(Y[tp,,])], na.rm = TRUE)})
sapply(1:32, function(tp){mean(Y[tp,,][upper.tri(Y[tp,,])], na.rm = TRUE)})
mean(Y[1,,][upper.tri(Y[1,,])])
mean(Y[1,,][upper.tri(Y[1,,])], na.rm = TRUE)
Y[1,,][upper.tri(Y[1,,])]
upper.tri(Y[1,,])
sapply(1:32, function(tp){mean(Y[tp,,][upper.tri(Y[tp,,])], na.rm = TRUE)})
library(gdata)#
dyadic<-read.table('/Users/bomin8319/Desktop/DaveMaggie/dataverse_files/Dyadicdata.tab', sep="\t", header=TRUE)#
raw <- read.table('/Users/bomin8319/Desktop/DaveMaggie/dataverse_files/RawVotingdata.tab', sep="\t", header=TRUE)#
ideal <- read.table('/Users/bomin8319/Desktop/DaveMaggie/dataverse_files/Idealpoints.tab', sep="\t", header=TRUE)#
description <- read.csv('/Users/bomin8319/Desktop/DaveMaggie/dataverse_files/descriptionsnew.csv',header=TRUE)#
description <- description[,-11:-12]
head(description)
library(gdata)#
ideal <- read.table('/Users/bomin8319/Desktop/DaveMaggie/dataverse_files/Idealpoints.tab', sep="\t", header=TRUE)#
description <- read.csv('/Users/bomin8319/Desktop/DaveMaggie/dataverse_files/descriptionsnew.csv',header=TRUE)#
#
important <- description[description$importantvote==1,-9:-10]#
time<-strptime(important[,7], "%m/%d/%y")#
years <-unique(time$year+1900)#
#
ideal <- ideal[ideal$Year %in% years,]#
#
countrycode <-unique(ideal[,c(2,3,6)])#
countrycode<-countrycode[order(countrycode[,1]),]
load('/Users/bomin8319/Desktop/DaveMaggie/agreedata.RData')
agreedata[[1]]
names(agreedata[[1]])
agreedata[[1]]$jointvote
reducedjoint = agreedata[[tp]]$jointvote[,reduced, reduced]
reduced <-which(dimnames(Y)[[2]] %in% c("USA", "CHN", "IND", "UKG", "FRN", "GFR", "TUR", "JPN", "ISR", "SYR", "LEB", "SUD", "IRN", "AUL", "PAK", "EGY", "AFG", "PRK", "RUS", "GRG", "UKR", "ROK", "IRQ"))#
#
#reduced <-which(dimnames(Y)[[2]] %in% c("USA", "CHN", "IND", "UKG", "FRN", "GFR", "TUR", "JPN", "ISR", "SYR", "LEB", "SUD", "IRN", "AUL", "PAK", "EGY"))#
Y = Y[, reduced, reduced]
reduced
names = which(rownames(agreedata[[tp]]$jointvote) %in% c("USA", "CHN", "IND", "UKG", "FRN", "GFR", "TUR", "JPN", "ISR", "SYR", "LEB", "SUD", "IRN", "AUL", "PAK", "EGY", "AFG", "PRK", "RUS", "GRG", "UKR", "ROK", "IRQ"))
names
length(names)
reducedjoint = agreedata[[tp]]$jointvote[,names, names]
tp
tp = 1
reducedjoint = agreedata[[tp]]$jointvote[names, names]
agreedata[[1]]$jointvote
agreedata[[1]]$jointvote[names, names]
tp
names = which(rownames(agreedata[[tp]]$jointvote) %in% c("USA", "CHN", "IND", "UKG", "FRN", "GFR", "TUR", "JPN", "ISR", "SYR", "LEB", "SUD", "IRN", "AUL", "PAK", "EGY", "AFG", "PRK", "RUS", "GRG", "UKR", "ROK", "IRQ"))
reducedjoint = agreedata[[tp]]$jointvote[names, names]
reducedjoint
mean(reducedjoint[upper.tri(reducedjoint)])
meanvec = c()#
for (tp in 1:32) {#
	names = which(rownames(agreedata[[tp]]$jointvote) %in% c("USA", "CHN", "IND", "UKG", "FRN", "GFR", "TUR", "JPN", "ISR", "SYR", "LEB", "SUD", "IRN", "AUL", "PAK", "EGY", "AFG", "PRK", "RUS", "GRG", "UKR", "ROK", "IRQ"))#
#
	reducedjoint = agreedata[[tp]]$jointvote[names, names]#
	meanvec[tp] = mean(reducedjoint[upper.tri(reducedjoint)])#
}
meanvec
names(meanvec) = years
meanvec
load("/Users/bomin8319/Desktop/DLFM/UNfit/DLFM_UNadditive.RData")#
UN1 = UN#
load("/Users/bomin8319/Desktop/DLFM/UNfit/DLFM_UNnoRE.RData")#
UN2 = UN#
load("/Users/bomin8319/Desktop/DLFM/UNfit/DLFM_UNRE.RData")#
UN = UN
attach(UN)#
library(ggplot2)#
library(MCMCpack)#
library(reshape2)#
library(gridExtra)#
library(ggrepel)#
library(RColorBrewer)#
years = c(1983:2014)#
load("/Users/bomin8319/Desktop/DLFM/UNfit/UNdatafull.RData")#
attach(UNdatafull)#
library(FastGP)#
library(mvtnorm)#
library(fields)#
library(reshape)#
library(MCMCpack)#
library(expm)#
library(igraph)#
#library(devtools)#
#install_github('bomin8319/DLFM/pkg')#
library(DLFM)#
reduced <-which(dimnames(Y)[[2]] %in% c("USA", "CHN", "IND", "UKG", "FRN", "GFR", "TUR", "JPN", "ISR", "SYR", "LEB", "SUD", "IRN", "AUL", "PAK", "EGY", "AFG", "PRK", "RUS", "GRG", "UKR", "ROK", "IRQ"))#
#
#reduced <-which(dimnames(Y)[[2]] %in% c("USA", "CHN", "IND", "UKG", "FRN", "GFR", "TUR", "JPN", "ISR", "SYR", "LEB", "SUD", "IRN", "AUL", "PAK", "EGY"))#
Y = Y[, reduced, reduced]#
X = X[, reduced, reduced, 1:5]#
#
for(tp in 1:32){#
	diag(X[tp,,,2]) = 0#
}#
# not existing countries -> all missing values imputed using model (biased)#
avail1 = matrix(1, 32, 23)#
avail1[1:8, c(12, 20)] =0 #North and South Korea did not joined UN voting until 1990#
avail1[1:10, 21] = 0 #GRG no voted until 1992#
avail1[1:9, 22] = 0 #RUS X variables not existed until 1991#
avail1[1:9, 23] = 0 #UKR not existed until 1991#
avail1[13:21, 9] = 0 #IRQ under sanction#
#
load("/Users/bomin8319/Desktop/DLFM/UNfit/clang.RData")#
rownames(clang)[36] = "GFR"#
diag(clang) = 1#
Xnew = array(NA, dim = c(32,23,23,6))#
dimnames(Xnew)[1] =dimnames(X)[1]#
dimnames(Xnew)[2] =dimnames(X)[2]#
dimnames(Xnew)[3] =dimnames(X)[3]#
dimnames(Xnew)[[4]] = c("intercept", "log(distance)", "polity", "alliance", "Trade/GDP", "language")#
Xnew[,,,1:5] = X#
order = rep(NA, 23)#
for (i in 1:23){#
	if (rownames(Y[1,,])[i] %in% rownames(clang) ) {#
order[i] = which(rownames(clang)==rownames(Y[1,,])[i])#
}#
}#
order2 = order[!is.na(order)]#
clang2 = matrix(NA, 23, 23)#
rownames(clang2) = colnames(clang2)=rownames(Y[1,,])#
clang2[-c(9, 21), -c(9, 21)] = clang[order2,order2]#
clang2[9, ] = clang2[10,]#
clang2[,9 ] = clang2[,10]#
clang2[21,] = 0#
clang2[,21]  =0#
diag(clang2)= 1#
for (t in 1:32){#
	Xnew[t,,,6] = clang2#
}
## side by side #
hi = factor(1983:2014)#
hello = list()#
hello2 = list()#
hello3 = list()#
hellonew = list()#
mean = list()#
countrynames = sort(rownames(U[[32]]))#
#
n2 = 1#
for 	(n in 1:23){#
	hello[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	mean[[n]] = matrix(NA, nrow = 0, ncol = 2)#
	for (d in 1:32){#
	hello[[n]]  = rbind(hello[[n]], cbind(UN$Degree[[d]][,n2], rep(hi[d], length(UN$Degree[[d]][,n2])), rep("AME", length(UN$Degree[[d]][,n2]))))#
	diag(Y[d,, ])= 0#
	Y[d, which(avail1[d,]==0), ] = 0#
	Y[d, , which(avail1[d,]==0)] = 0#
	mean[[n]] = rbind(mean[[n]], c(rowSums(Y[d,,], na.rm=TRUE)[n2], hi[d]))#
}#
colnames(hello[[n]]) = c("Degree", "Year", "Model")#
hello[[n]] = as.data.frame(hello[[n]])#
hello[[n]]$Year = factor(sort(as.numeric(hello[[n]]$Year)), labels = c(1983:2014))#
#
	hello2[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello2[[n]]  = rbind(hello2[[n]], cbind(UN1$Degree[[d]][,n2], rep(hi[d], length(UN1$Degree[[d]][,n2])), rep("AE", length(UN1$Degree[[d]][,n2]))))#
	}#
colnames(hello2[[n]]) = c("Degree", "Year", "Model")#
hello2[[n]] = as.data.frame(hello2[[n]])#
hello2[[n]]$Year = factor(sort(as.numeric(hello2[[n]]$Year)), labels = c(1983:2014))#
#
hello3[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello3[[n]]  = rbind(hello3[[n]], cbind(UN2$Degree[[d]][,n2], rep(hi[d], length(UN2$Degree[[d]][,n2])), rep("NO", length(UN2$Degree[[d]][,n2]))))#
	}#
colnames(hello3[[n]]) = c("Degree", "Year", "Model")#
hello3[[n]] = as.data.frame(hello3[[n]])#
hello3[[n]]$Year = factor(sort(as.numeric(hello3[[n]]$Year)), labels = c(1983:2014))#
hellonew[[n]] = as.data.frame(rbind(hello[[n]], hello2[[n]], hello3[[n]]))#
colnames(mean[[n]]) =  c("Degree", "Year")#
mean[[n]] = as.data.frame(mean[[n]])#
n2 = n2 + 1#
}#
#
countryname = sort(rownames(U[[32]]))#
countryname2 = (rownames(U[[32]]))#
ggplotColours <- function(n = 6, h = c(0, 360) + 15){#
  if ((diff(h) %% 360) < 1) h[2] <- h[2] - 360/n#
  hcl(h = (seq(h[1], h[2], length = n)), c = 100, l = 65)#
}
countrynames
countryname
UN$degree[[1]]
UN$Degree[[1]]
countryname = (rownames(U[[32]]))#
countryname2 = (rownames(U[[32]]))#
ggplotColours <- function(n = 6, h = c(0, 360) + 15){#
  if ((diff(h) %% 360) < 1) h[2] <- h[2] - 360/n#
  hcl(h = (seq(h[1], h[2], length = n)), c = 100, l = 65)#
}#
#
countrynames = ggplotColours(23)#
p10 = list()#
n2 = 1#
for (n in 1:23){#
	hellonew[[n]]$Degree = as.numeric(as.character(hellonew[[n]]$Degree))#
p10[[n]] = ggplot(hellonew[[n]], aes(x = Year, y = Degree, colour = as.factor(Model))) + geom_boxplot(outlier.size = 0.5, position = position_dodge()) + theme_bw() + scale_colour_discrete(name = countryname[n]) + geom_line(data = mean[[n]], colour = "grey60", size = 1)#
#annotate("text", 30, 10, size = 5, label = countryname2[n], colour = countrynames[n])#
n2 = n2 + 1#
#
mname = paste0(countryname2[n], n, ".png")#
print(p10[[n]])#
ggsave(filename = mname, width = 10, height = 6)#
}
#clear memory  #
rm(list=ls())                                           #
library(car)#
library(Hmisc)                                                     #
library(mvtnorm)#
library(foreign)#
library(graphics)#
library(MASS)#
library(lattice)#
library(tseries)#
library(Matrix)#
library(Design)#
library(msm)#
library(corpcor)#
library(Zelig)#
Results<-read.dta("/Users/bomin8319/Desktop/BayesOFsurv/coding material/Monte Carlos/Mixture DGP/main.data1000_10.dta")#
Results<-as.matrix(Results, )#
#
resize.win <- function(Width=6, Height=6)#
{#
        # works for windows#
    dev.off(); # dev.new(width=6, height=6)#
    windows(record=TRUE, width=Width, height=Height)#
}#
resize.win(7,4)#
#
par(mfrow=c(2,3))#
par(cex.lab=1)#
par(cex.axis=1)#
par(cex.main=1)#
#
par(mar=c(5.1,4.1,2.1,2.1))#
#sets the bottom, left, top and right
local.xlim<-c(-0.3,1.6)#
local.ylim<-c(0,6.6)#
plot(density(Results[,11],na.rm=TRUE), main = "",  ylab = "", xlab = "", xlim=local.xlim, ylim=local.ylim,col="blue", xaxt='n', yaxt='n')#
abline(v=1,lty=3)#
par(new=TRUE)#
plot(density(Results[,21],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,25],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="pink", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,47],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="forestgreen", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,53],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,35],na.rm=TRUE), main = "", xlab = "Beta 0",xlim=local.xlim, ylim=local.ylim,col="purple")#
text (x=.7, y =6.4, "Z.Exp",col="red")#
text (x=.7, y =6, "Z.Wei",col="forestgreen")#
text (x=1.33, y =6.25, "Exp",col="blue")#
text (x=1.5, y =6.25, "Wei",col="purple")#
text (x=0.7, y =5.5, "BZ.Exp",col="pink")#
text (x=0, y =6.25, "BZ.Wei",col="orange")#
par(new=FALSE)#
#B1#
local.xlim<-c(3.40,3.6)#
local.ylim<-c(0,46.5)#
plot(density(Results[,13],na.rm=TRUE), main = "",  ylab = "", xlab = "", xlim=local.xlim, ylim=local.ylim,col="blue", xaxt='n', yaxt='n')#
abline(v=3.5,lty=3)#
par(new=TRUE)#
plot(density(Results[,23],na.rm=TRUE), main = "", ylab = "",  xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,27],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="pink", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,37],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,55],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,49],na.rm=TRUE), main = "", xlab = "Beta 1",xlim=local.xlim, ylim=local.ylim,col="forestgreen")#
#
text (x=3.55, y =42, "Z.Exp",col="red")#
text (x=3.425, y =40, "Z.Wei",col="purple")#
text (x=3.425, y =42, "Exp",col="blue")#
text (x=3.55, y =36, "Wei",col="forestgreen")#
text (x=3.55, y =40, "BZ.Exp",col="pink")#
text (x=3.55, y =38, "BZ.Wei",col="orange")#
par(new=FALSE)
local.ylim<-c(0,20)#
local.xlim<-c(0.75,1.1)#
plot(density(Results[,39],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="forestgreen", xaxt='n', yaxt='n')#
abline(v=1,lty=3)#
par(new=TRUE)#
plot(density(Results[,63],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,51],na.rm=TRUE), main =" ", xlab = "P",xlim=local.xlim, ylim=local.ylim,col="purple")#
text (x=1.06, y =15.2, "Z.Wei",col="purple")#
text (x=1.06, y =14.2, "BZ.Wei",col="orange")#
text (x=.78, y =18, "Wei",col="forestgreen")#
par(new=FALSE)
#B1#
local.ylim<-c(0,.5)#
local.xlim<-c(-8,2.5)#
plot(density(Results[,15],na.rm=TRUE), main = "", ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
abline(v=-2,lty=3)#
par(new=TRUE)#
plot(density(Results[,29],na.rm=TRUE), main = "", xlab = "Gamma 0",xlim=local.xlim, ylim=local.ylim,col="pink")#
par(new=TRUE)#
plot(density(Results[,41],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple")#
par(new=TRUE)#
plot(density(Results[,57],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange")#
text (x=-4, y =.38, "Z.Exp",col="red")#
text (x=1, y =.38, "BZ.Exp",col="pink")#
text (x=1, y =.35, "BZ.Wei",col="orange")#
text (x=-4, y =0.35, "Z.Wei",col="purple")#
par(new=FALSE)
local.ylim<-c(0,1.25)#
local.xlim<-c(.5,6)#
plot(density(Results[,17],na.rm=TRUE), main = "", ylab = "",  xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
abline(v=2,lty=3)#
par(new=TRUE)#
plot(density(Results[,31],na.rm=TRUE), main = "", xlab = "Gamma 1",xlim=local.xlim, ylim=local.ylim,col="pink")#
par(new=TRUE)#
plot(density(Results[,43],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple")#
par(new=TRUE)#
plot(density(Results[,59],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange")#
text (x=2.75, y =.86, "Z.Exp",col="red")#
text (x=1, y =.86, "BZ.Exp",col="pink")#
text (x=2.75, y =.80, "Z.Wei",col="purple")#
text (x=1, y =.92, "BZ.Wei",col="orange")#
par(new=FALSE)
local.ylim<-c(0,0.8)#
local.xlim<-c(1,8.5)#
plot(density(Results[,19],na.rm=TRUE), main = "", ylab = "",  xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
abline(v=3,lty=3)#
par(new=TRUE)#
plot(density(Results[,33],na.rm=TRUE), main = "", xlab = "Gamma 2",xlim=local.xlim, ylim=local.ylim,col="pink")#
par(new=TRUE)#
plot(density(Results[,45],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple")#
par(new=TRUE)#
plot(density(Results[,61],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange")#
text (x=4.1, y =.6, "Z.Exp",col="red")#
text (x=4.1, y =.65, "BZ.Exp",col="pink")#
text (x=4.1, y =.55, "Z.Wei",col="purple")#
text (x=4.1, y =.70, "BZ.Wei",col="orange")#
par(new=FALSE)
par(mfrow=c(2,3))#
par(cex.lab=1)#
par(cex.axis=1)#
par(cex.main=1)#
#
par(mar=c(5.1,4.1,2.1,2.1))#
#sets the bottom, left, top and right #
#
#B0#
local.xlim<-c(-0.3,1.6)#
local.ylim<-c(0,6.6)#
plot(density(Results[,11],na.rm=TRUE), main = "",  ylab = "", xlab = "", xlim=local.xlim, ylim=local.ylim,col="blue", xaxt='n', yaxt='n')#
abline(v=1,lty=3)#
par(new=TRUE)#
plot(density(Results[,21],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,25],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="pink", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,47],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="forestgreen", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,53],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,35],na.rm=TRUE), main = "", xlab = "Beta 0",xlim=local.xlim, ylim=local.ylim,col="purple")#
text (x=.7, y =6.4, "Z.Exp",col="red")#
text (x=.7, y =6, "Z.Wei",col="forestgreen")#
text (x=1.33, y =6.25, "Exp",col="blue")#
text (x=1.5, y =6.25, "Wei",col="purple")#
text (x=0.7, y =5.5, "BZ.Exp",col="pink")#
text (x=0, y =6.25, "BZ.Wei",col="orange")#
par(new=FALSE)#
#B1#
local.xlim<-c(3.40,3.6)#
local.ylim<-c(0,46.5)#
plot(density(Results[,13],na.rm=TRUE), main = "",  ylab = "", xlab = "", xlim=local.xlim, ylim=local.ylim,col="blue", xaxt='n', yaxt='n')#
abline(v=3.5,lty=3)#
par(new=TRUE)#
plot(density(Results[,23],na.rm=TRUE), main = "", ylab = "",  xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,27],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="pink", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,37],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,55],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,49],na.rm=TRUE), main = "", xlab = "Beta 1",xlim=local.xlim, ylim=local.ylim,col="forestgreen")#
#
text (x=3.55, y =42, "Z.Exp",col="red")#
text (x=3.425, y =40, "Z.Wei",col="purple")#
text (x=3.425, y =42, "Exp",col="blue")#
text (x=3.55, y =36, "Wei",col="forestgreen")#
text (x=3.55, y =40, "BZ.Exp",col="pink")#
text (x=3.55, y =38, "BZ.Wei",col="orange")#
par(new=FALSE)#
#
#B1#
local.ylim<-c(0,20)#
local.xlim<-c(0.75,1.1)#
plot(density(Results[,39],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="forestgreen", xaxt='n', yaxt='n')#
abline(v=1,lty=3)#
par(new=TRUE)#
plot(density(Results[,63],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,51],na.rm=TRUE), main =" ", xlab = "P",xlim=local.xlim, ylim=local.ylim,col="purple")#
text (x=1.06, y =15.2, "Z.Wei",col="purple")#
text (x=1.06, y =14.2, "BZ.Wei",col="orange")#
text (x=.78, y =18, "Wei",col="forestgreen")#
par(new=FALSE)#
#
#B1#
local.ylim<-c(0,1)#
local.xlim<-c(-8,5)#
plot(density(Results[,15],na.rm=TRUE), main = "", ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
abline(v=-0.5,lty=3)#
par(new=TRUE)#
plot(density(Results[,29],na.rm=TRUE), main = "", xlab = "Gamma 0",xlim=local.xlim, ylim=local.ylim,col="pink")#
par(new=TRUE)#
plot(density(Results[,41],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple")#
par(new=TRUE)#
plot(density(Results[,57],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange")#
text (x=-4, y =.38, "Z.Exp",col="red")#
text (x=1, y =.38, "BZ.Exp",col="pink")#
text (x=1, y =.35, "BZ.Wei",col="orange")#
text (x=-4, y =0.35, "Z.Wei",col="purple")#
par(new=FALSE)
#B1#
local.ylim<-c(0,20)#
local.xlim<-c(0.75,1.1)#
plot(density(Results[,39],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="forestgreen", xaxt='n', yaxt='n')#
abline(v=1.965,lty=3)#
par(new=TRUE)#
plot(density(Results[,63],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,51],na.rm=TRUE), main =" ", xlab = "P",xlim=local.xlim, ylim=local.ylim,col="purple")#
text (x=1.06, y =15.2, "Z.Wei",col="purple")#
text (x=1.06, y =14.2, "BZ.Wei",col="orange")#
text (x=.78, y =18, "Wei",col="forestgreen")#
par(new=FALSE)
par(mfrow=c(2,3))#
par(cex.lab=1)#
par(cex.axis=1)#
par(cex.main=1)#
#
par(mar=c(5.1,4.1,2.1,2.1))#
#sets the bottom, left, top and right #
#
#B0#
local.xlim<-c(-0.3,1.6)#
local.ylim<-c(0,6.6)#
plot(density(Results[,11],na.rm=TRUE), main = "",  ylab = "", xlab = "", xlim=local.xlim, ylim=local.ylim,col="blue", xaxt='n', yaxt='n')#
abline(v=1,lty=3)#
par(new=TRUE)#
plot(density(Results[,21],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,25],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="pink", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,47],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="forestgreen", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,53],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,35],na.rm=TRUE), main = "", xlab = "Beta 0",xlim=local.xlim, ylim=local.ylim,col="purple")#
text (x=.7, y =6.4, "Z.Exp",col="red")#
text (x=.7, y =6, "Z.Wei",col="forestgreen")#
text (x=1.33, y =6.25, "Exp",col="blue")#
text (x=1.5, y =6.25, "Wei",col="purple")#
text (x=0.7, y =5.5, "BZ.Exp",col="pink")#
text (x=0, y =6.25, "BZ.Wei",col="orange")#
par(new=FALSE)#
#B1#
local.xlim<-c(3.40,3.6)#
local.ylim<-c(0,46.5)#
plot(density(Results[,13],na.rm=TRUE), main = "",  ylab = "", xlab = "", xlim=local.xlim, ylim=local.ylim,col="blue", xaxt='n', yaxt='n')#
abline(v=3.5,lty=3)#
par(new=TRUE)#
plot(density(Results[,23],na.rm=TRUE), main = "", ylab = "",  xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,27],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="pink", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,37],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,55],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,49],na.rm=TRUE), main = "", xlab = "Beta 1",xlim=local.xlim, ylim=local.ylim,col="forestgreen")#
#
text (x=3.55, y =42, "Z.Exp",col="red")#
text (x=3.425, y =40, "Z.Wei",col="purple")#
text (x=3.425, y =42, "Exp",col="blue")#
text (x=3.55, y =36, "Wei",col="forestgreen")#
text (x=3.55, y =40, "BZ.Exp",col="pink")#
text (x=3.55, y =38, "BZ.Wei",col="orange")#
par(new=FALSE)#
#
#B1#
local.ylim<-c(0,20)#
local.xlim<-c(0.75,1.1)#
plot(density(Results[,39],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="forestgreen", xaxt='n', yaxt='n')#
abline(v=1,lty=3)#
par(new=TRUE)#
plot(density(Results[,63],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,51],na.rm=TRUE), main =" ", xlab = "P",xlim=local.xlim, ylim=local.ylim,col="purple")#
text (x=1.06, y =15.2, "Z.Wei",col="purple")#
text (x=1.06, y =14.2, "BZ.Wei",col="orange")#
text (x=.78, y =18, "Wei",col="forestgreen")#
par(new=FALSE)#
#
#B1#
local.ylim<-c(0,1)#
local.xlim<-c(-8,5)#
plot(density(Results[,15],na.rm=TRUE), main = "", ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
abline(v=-0.5,lty=3)#
par(new=TRUE)#
plot(density(Results[,29],na.rm=TRUE), main = "", xlab = "Gamma 0",xlim=local.xlim, ylim=local.ylim,col="pink")#
par(new=TRUE)#
plot(density(Results[,41],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple")#
par(new=TRUE)#
plot(density(Results[,57],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange")#
text (x=-4, y =.38, "Z.Exp",col="red")#
text (x=1, y =.38, "BZ.Exp",col="pink")#
text (x=1, y =.35, "BZ.Wei",col="orange")#
text (x=-4, y =0.35, "Z.Wei",col="purple")#
par(new=FALSE)#
#B1#
local.ylim<-c(0,1.25)#
local.xlim<-c(.5,6)#
plot(density(Results[,17],na.rm=TRUE), main = "", ylab = "",  xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
abline(v=1.965,lty=3)#
par(new=TRUE)#
plot(density(Results[,31],na.rm=TRUE), main = "", xlab = "Gamma 1",xlim=local.xlim, ylim=local.ylim,col="pink")#
par(new=TRUE)#
plot(density(Results[,43],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple")#
par(new=TRUE)#
plot(density(Results[,59],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange")#
text (x=2.75, y =.86, "Z.Exp",col="red")#
text (x=1, y =.86, "BZ.Exp",col="pink")#
text (x=2.75, y =.80, "Z.Wei",col="purple")#
text (x=1, y =.92, "BZ.Wei",col="orange")#
par(new=FALSE)
local.ylim<-c(0,0.8)#
local.xlim<-c(1,8.5)#
plot(density(Results[,19],na.rm=TRUE), main = "", ylab = "",  xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
abline(v=-0.5,lty=3)#
par(new=TRUE)#
plot(density(Results[,33],na.rm=TRUE), main = "", xlab = "Gamma 2",xlim=local.xlim, ylim=local.ylim,col="pink")#
par(new=TRUE)#
plot(density(Results[,45],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple")#
par(new=TRUE)#
plot(density(Results[,61],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange")#
text (x=4.1, y =.6, "Z.Exp",col="red")#
text (x=4.1, y =.65, "BZ.Exp",col="pink")#
text (x=4.1, y =.55, "Z.Wei",col="purple")#
text (x=4.1, y =.70, "BZ.Wei",col="orange")#
par(new=FALSE)
#B1#
local.ylim<-c(0,0.8)#
local.xlim<-c(-2,5)#
plot(density(Results[,19],na.rm=TRUE), main = "", ylab = "",  xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
abline(v=-0.5,lty=3)#
par(new=TRUE)#
plot(density(Results[,33],na.rm=TRUE), main = "", xlab = "Gamma 2",xlim=local.xlim, ylim=local.ylim,col="pink")#
par(new=TRUE)#
plot(density(Results[,45],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple")#
par(new=TRUE)#
plot(density(Results[,61],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange")#
text (x=4.1, y =.6, "Z.Exp",col="red")#
text (x=4.1, y =.65, "BZ.Exp",col="pink")#
text (x=4.1, y =.55, "Z.Wei",col="purple")#
text (x=4.1, y =.70, "BZ.Wei",col="orange")#
par(new=FALSE)
par(mfrow=c(2,3))#
par(cex.lab=1)#
par(cex.axis=1)#
par(cex.main=1)#
#
par(mar=c(5.1,4.1,2.1,2.1))#
#sets the bottom, left, top and right #
#
#B0#
local.xlim<-c(-0.3,1.6)#
local.ylim<-c(0,6.6)#
plot(density(Results[,11],na.rm=TRUE), main = "",  ylab = "", xlab = "", xlim=local.xlim, ylim=local.ylim,col="blue", xaxt='n', yaxt='n')#
abline(v=1,lty=3)#
par(new=TRUE)#
plot(density(Results[,21],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,25],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="pink", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,47],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="forestgreen", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,53],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,35],na.rm=TRUE), main = "", xlab = "Beta 0",xlim=local.xlim, ylim=local.ylim,col="purple")#
text (x=.7, y =6.4, "Z.Exp",col="red")#
text (x=.7, y =6, "Z.Wei",col="forestgreen")#
text (x=1.33, y =6.25, "Exp",col="blue")#
text (x=1.5, y =6.25, "Wei",col="purple")#
text (x=0.7, y =5.5, "BZ.Exp",col="pink")#
text (x=0, y =6.25, "BZ.Wei",col="orange")#
par(new=FALSE)#
#B1#
local.xlim<-c(3.40,3.6)#
local.ylim<-c(0,46.5)#
plot(density(Results[,13],na.rm=TRUE), main = "",  ylab = "", xlab = "", xlim=local.xlim, ylim=local.ylim,col="blue", xaxt='n', yaxt='n')#
abline(v=3.5,lty=3)#
par(new=TRUE)#
plot(density(Results[,23],na.rm=TRUE), main = "", ylab = "",  xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,27],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="pink", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,37],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,55],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,49],na.rm=TRUE), main = "", xlab = "Beta 1",xlim=local.xlim, ylim=local.ylim,col="forestgreen")#
#
text (x=3.55, y =42, "Z.Exp",col="red")#
text (x=3.425, y =40, "Z.Wei",col="purple")#
text (x=3.425, y =42, "Exp",col="blue")#
text (x=3.55, y =36, "Wei",col="forestgreen")#
text (x=3.55, y =40, "BZ.Exp",col="pink")#
text (x=3.55, y =38, "BZ.Wei",col="orange")#
par(new=FALSE)#
#
#B1#
local.ylim<-c(0,20)#
local.xlim<-c(0.75,1.1)#
plot(density(Results[,39],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="forestgreen", xaxt='n', yaxt='n')#
abline(v=1,lty=3)#
par(new=TRUE)#
plot(density(Results[,63],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,51],na.rm=TRUE), main =" ", xlab = "P",xlim=local.xlim, ylim=local.ylim,col="purple")#
text (x=1.06, y =15.2, "Z.Wei",col="purple")#
text (x=1.06, y =14.2, "BZ.Wei",col="orange")#
text (x=.78, y =18, "Wei",col="forestgreen")#
par(new=FALSE)#
#
#B1#
local.ylim<-c(0,1)#
local.xlim<-c(-8,5)#
plot(density(Results[,15],na.rm=TRUE), main = "", ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
abline(v=-0.5,lty=3)#
par(new=TRUE)#
plot(density(Results[,29],na.rm=TRUE), main = "", xlab = "Gamma 0",xlim=local.xlim, ylim=local.ylim,col="pink")#
par(new=TRUE)#
plot(density(Results[,41],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple")#
par(new=TRUE)#
plot(density(Results[,57],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange")#
text (x=-4, y =.38, "Z.Exp",col="red")#
text (x=1, y =.38, "BZ.Exp",col="pink")#
text (x=1, y =.35, "BZ.Wei",col="orange")#
text (x=-4, y =0.35, "Z.Wei",col="purple")#
par(new=FALSE)#
#B1#
local.ylim<-c(0,1.25)#
local.xlim<-c(.5,6)#
plot(density(Results[,17],na.rm=TRUE), main = "", ylab = "",  xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
abline(v=1.965,lty=3)#
par(new=TRUE)#
plot(density(Results[,31],na.rm=TRUE), main = "", xlab = "Gamma 1",xlim=local.xlim, ylim=local.ylim,col="pink")#
par(new=TRUE)#
plot(density(Results[,43],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple")#
par(new=TRUE)#
plot(density(Results[,59],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange")#
text (x=2.75, y =.86, "Z.Exp",col="red")#
text (x=1, y =.86, "BZ.Exp",col="pink")#
text (x=2.75, y =.80, "Z.Wei",col="purple")#
text (x=1, y =.92, "BZ.Wei",col="orange")#
par(new=FALSE)#
#
#B1#
local.ylim<-c(0,2)#
local.xlim<-c(-2,5)#
plot(density(Results[,19],na.rm=TRUE), main = "", ylab = "",  xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
abline(v=-0.5,lty=3)#
par(new=TRUE)#
plot(density(Results[,33],na.rm=TRUE), main = "", xlab = "Gamma 2",xlim=local.xlim, ylim=local.ylim,col="pink")#
par(new=TRUE)#
plot(density(Results[,45],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple")#
par(new=TRUE)#
plot(density(Results[,61],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange")#
text (x=4.1, y =.6, "Z.Exp",col="red")#
text (x=4.1, y =.65, "BZ.Exp",col="pink")#
text (x=4.1, y =.55, "Z.Wei",col="purple")#
text (x=4.1, y =.70, "BZ.Wei",col="orange")#
par(new=FALSE)
par(mfrow=c(2,3))#
par(cex.lab=1)#
par(cex.axis=1)#
par(cex.main=1)#
#
par(mar=c(5.1,4.1,2.1,2.1))#
#sets the bottom, left, top and right #
#
#B0#
local.xlim<-c(-0.3,1.6)#
local.ylim<-c(0,6.6)#
plot(density(Results[,11],na.rm=TRUE), main = "",  ylab = "", xlab = "", xlim=local.xlim, ylim=local.ylim,col="blue", xaxt='n', yaxt='n')#
abline(v=1,lty=3)#
par(new=TRUE)#
plot(density(Results[,21],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,25],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="pink", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,47],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="forestgreen", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,53],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,35],na.rm=TRUE), main = "", xlab = "Beta 0",xlim=local.xlim, ylim=local.ylim,col="purple")#
text (x=.7, y =6.4, "Z.Exp",col="red")#
text (x=.7, y =6, "Z.Wei",col="forestgreen")#
text (x=1.33, y =6.25, "Exp",col="blue")#
text (x=1.5, y =6.25, "Wei",col="purple")#
text (x=0.7, y =5.5, "BZ.Exp",col="pink")#
text (x=0, y =6.25, "BZ.Wei",col="orange")#
par(new=FALSE)#
#B1#
local.xlim<-c(3.40,3.6)#
local.ylim<-c(0,46.5)#
plot(density(Results[,13],na.rm=TRUE), main = "",  ylab = "", xlab = "", xlim=local.xlim, ylim=local.ylim,col="blue", xaxt='n', yaxt='n')#
abline(v=3.5,lty=3)#
par(new=TRUE)#
plot(density(Results[,23],na.rm=TRUE), main = "", ylab = "",  xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,27],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="pink", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,37],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,55],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,49],na.rm=TRUE), main = "", xlab = "Beta 1",xlim=local.xlim, ylim=local.ylim,col="forestgreen")#
#
text (x=3.55, y =42, "Z.Exp",col="red")#
text (x=3.425, y =40, "Z.Wei",col="purple")#
text (x=3.425, y =42, "Exp",col="blue")#
text (x=3.55, y =36, "Wei",col="forestgreen")#
text (x=3.55, y =40, "BZ.Exp",col="pink")#
text (x=3.55, y =38, "BZ.Wei",col="orange")#
par(new=FALSE)#
#
#B1#
local.ylim<-c(0,20)#
local.xlim<-c(0.75,1.1)#
plot(density(Results[,39],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="forestgreen", xaxt='n', yaxt='n')#
abline(v=1,lty=3)#
par(new=TRUE)#
plot(density(Results[,63],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,51],na.rm=TRUE), main =" ", xlab = "P",xlim=local.xlim, ylim=local.ylim,col="purple")#
text (x=1.06, y =15.2, "Z.Wei",col="purple")#
text (x=1.06, y =14.2, "BZ.Wei",col="orange")#
text (x=.78, y =18, "Wei",col="forestgreen")#
par(new=FALSE)#
#
#B1#
local.ylim<-c(0,1)#
local.xlim<-c(-8,5)#
plot(density(Results[,15],na.rm=TRUE), main = "", ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
abline(v=-0.5,lty=3)#
par(new=TRUE)#
plot(density(Results[,29],na.rm=TRUE), main = "", xlab = "Gamma 0",xlim=local.xlim, ylim=local.ylim,col="pink")#
par(new=TRUE)#
plot(density(Results[,41],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple")#
par(new=TRUE)#
plot(density(Results[,57],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange")#
text (x=-4, y =.38, "Z.Exp",col="red")#
text (x=1, y =.38, "BZ.Exp",col="pink")#
text (x=1, y =.35, "BZ.Wei",col="orange")#
text (x=-4, y =0.35, "Z.Wei",col="purple")#
par(new=FALSE)#
#B1#
local.ylim<-c(0,1.25)#
local.xlim<-c(.5,6)#
plot(density(Results[,17],na.rm=TRUE), main = "", ylab = "",  xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
abline(v=1.965,lty=3)#
par(new=TRUE)#
plot(density(Results[,31],na.rm=TRUE), main = "", xlab = "Gamma 1",xlim=local.xlim, ylim=local.ylim,col="pink")#
par(new=TRUE)#
plot(density(Results[,43],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple")#
par(new=TRUE)#
plot(density(Results[,59],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange")#
text (x=2.75, y =.86, "Z.Exp",col="red")#
text (x=1, y =.86, "BZ.Exp",col="pink")#
text (x=2.75, y =.80, "Z.Wei",col="purple")#
text (x=1, y =.92, "BZ.Wei",col="orange")#
par(new=FALSE)#
#
#B1#
local.ylim<-c(0,3)#
local.xlim<-c(-2,5)#
plot(density(Results[,19],na.rm=TRUE), main = "", ylab = "",  xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
abline(v=-0.5,lty=3)#
par(new=TRUE)#
plot(density(Results[,33],na.rm=TRUE), main = "", xlab = "Gamma 2",xlim=local.xlim, ylim=local.ylim,col="pink")#
par(new=TRUE)#
plot(density(Results[,45],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple")#
par(new=TRUE)#
plot(density(Results[,61],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange")#
text (x=4.1, y =.6, "Z.Exp",col="red")#
text (x=4.1, y =.65, "BZ.Exp",col="pink")#
text (x=4.1, y =.55, "Z.Wei",col="purple")#
text (x=4.1, y =.70, "BZ.Wei",col="orange")#
par(new=FALSE)
head(main.data)
head(Results)
#clear memory  #
rm(list=ls())                                           #
library(car)#
library(Hmisc)                                                     #
library(mvtnorm)#
library(foreign)#
library(graphics)#
library(MASS)#
library(lattice)#
library(tseries)#
library(Matrix)#
library(Design)#
library(msm)#
library(corpcor)#
library(Zelig)#
Results<-read.dta("/Users/bomin8319/Desktop/BayesOFsurv/coding material/Monte Carlos/Mixture DGP/main.data1000_20.dta")#
Results<-as.matrix(Results, )#
#
resize.win <- function(Width=6, Height=6)#
{#
        # works for windows#
    dev.off(); # dev.new(width=6, height=6)#
    windows(record=TRUE, width=Width, height=Height)#
}#
resize.win(7,4)#
#
par(mfrow=c(2,3))#
par(cex.lab=1)#
par(cex.axis=1)#
par(cex.main=1)#
#
par(mar=c(5.1,4.1,2.1,2.1))#
#sets the bottom, left, top and right #
#
#B0#
local.xlim<-c(-0.3,1.6)#
local.ylim<-c(0,6.6)#
plot(density(Results[,11],na.rm=TRUE), main = "",  ylab = "", xlab = "", xlim=local.xlim, ylim=local.ylim,col="blue", xaxt='n', yaxt='n')#
abline(v=1,lty=3)#
par(new=TRUE)#
plot(density(Results[,21],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,25],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="pink", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,47],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="forestgreen", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,53],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,35],na.rm=TRUE), main = "", xlab = "Beta 0",xlim=local.xlim, ylim=local.ylim,col="purple")#
text (x=.7, y =6.4, "Z.Exp",col="red")#
text (x=.7, y =6, "Z.Wei",col="forestgreen")#
text (x=1.33, y =6.25, "Exp",col="blue")#
text (x=1.5, y =6.25, "Wei",col="purple")#
text (x=0.7, y =5.5, "BZ.Exp",col="pink")#
text (x=0, y =6.25, "BZ.Wei",col="orange")#
par(new=FALSE)#
#B1#
local.xlim<-c(3.40,3.6)#
local.ylim<-c(0,46.5)#
plot(density(Results[,13],na.rm=TRUE), main = "",  ylab = "", xlab = "", xlim=local.xlim, ylim=local.ylim,col="blue", xaxt='n', yaxt='n')#
abline(v=3.5,lty=3)#
par(new=TRUE)#
plot(density(Results[,23],na.rm=TRUE), main = "", ylab = "",  xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,27],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="pink", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,37],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,55],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,49],na.rm=TRUE), main = "", xlab = "Beta 1",xlim=local.xlim, ylim=local.ylim,col="forestgreen")#
#
text (x=3.55, y =42, "Z.Exp",col="red")#
text (x=3.425, y =40, "Z.Wei",col="purple")#
text (x=3.425, y =42, "Exp",col="blue")#
text (x=3.55, y =36, "Wei",col="forestgreen")#
text (x=3.55, y =40, "BZ.Exp",col="pink")#
text (x=3.55, y =38, "BZ.Wei",col="orange")#
par(new=FALSE)#
#
#B1#
local.ylim<-c(0,20)#
local.xlim<-c(0.75,1.1)#
plot(density(Results[,39],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="forestgreen", xaxt='n', yaxt='n')#
abline(v=1,lty=3)#
par(new=TRUE)#
plot(density(Results[,63],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,51],na.rm=TRUE), main =" ", xlab = "P",xlim=local.xlim, ylim=local.ylim,col="purple")#
text (x=1.06, y =15.2, "Z.Wei",col="purple")#
text (x=1.06, y =14.2, "BZ.Wei",col="orange")#
text (x=.78, y =18, "Wei",col="forestgreen")#
par(new=FALSE)#
#
#B1#
local.ylim<-c(0,1)#
local.xlim<-c(-8,5)#
plot(density(Results[,15],na.rm=TRUE), main = "", ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
abline(v=-0.5,lty=3)#
par(new=TRUE)#
plot(density(Results[,29],na.rm=TRUE), main = "", xlab = "Gamma 0",xlim=local.xlim, ylim=local.ylim,col="pink")#
par(new=TRUE)#
plot(density(Results[,41],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple")#
par(new=TRUE)#
plot(density(Results[,57],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange")#
text (x=-4, y =.38, "Z.Exp",col="red")#
text (x=1, y =.38, "BZ.Exp",col="pink")#
text (x=1, y =.35, "BZ.Wei",col="orange")#
text (x=-4, y =0.35, "Z.Wei",col="purple")#
par(new=FALSE)#
#B1#
local.ylim<-c(0,1.25)#
local.xlim<-c(.5,6)#
plot(density(Results[,17],na.rm=TRUE), main = "", ylab = "",  xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
abline(v=1.965,lty=3)#
par(new=TRUE)#
plot(density(Results[,31],na.rm=TRUE), main = "", xlab = "Gamma 1",xlim=local.xlim, ylim=local.ylim,col="pink")#
par(new=TRUE)#
plot(density(Results[,43],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple")#
par(new=TRUE)#
plot(density(Results[,59],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange")#
text (x=2.75, y =.86, "Z.Exp",col="red")#
text (x=1, y =.86, "BZ.Exp",col="pink")#
text (x=2.75, y =.80, "Z.Wei",col="purple")#
text (x=1, y =.92, "BZ.Wei",col="orange")#
par(new=FALSE)#
#
#B1#
local.ylim<-c(0,3)#
local.xlim<-c(-2,5)#
plot(density(Results[,19],na.rm=TRUE), main = "", ylab = "",  xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
abline(v=-0.5,lty=3)#
par(new=TRUE)#
plot(density(Results[,33],na.rm=TRUE), main = "", xlab = "Gamma 2",xlim=local.xlim, ylim=local.ylim,col="pink")#
par(new=TRUE)#
plot(density(Results[,45],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple")#
par(new=TRUE)#
plot(density(Results[,61],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange")#
text (x=4.1, y =.6, "Z.Exp",col="red")#
text (x=4.1, y =.65, "BZ.Exp",col="pink")#
text (x=4.1, y =.55, "Z.Wei",col="purple")#
text (x=4.1, y =.70, "BZ.Wei",col="orange")#
par(new=FALSE)
head(Results)
Results<-read.dta("/Users/bomin8319/Desktop/BayesOFsurv/coding material/Monte Carlos/Mixture DGP/main.data1000_20.dta")#
Results<-as.matrix(Results, )#
#
resize.win <- function(Width=6, Height=6)#
{#
        # works for windows#
    dev.off(); # dev.new(width=6, height=6)#
    windows(record=TRUE, width=Width, height=Height)#
}#
resize.win(7,4)#
#
par(mfrow=c(2,3))#
par(cex.lab=1)#
par(cex.axis=1)#
par(cex.main=1)#
#
par(mar=c(5.1,4.1,2.1,2.1))#
#sets the bottom, left, top and right #
#
#B0#
local.xlim<-c(-0.3,1.6)#
local.ylim<-c(0,6.6)#
plot(density(Results[,11],na.rm=TRUE), main = "",  ylab = "", xlab = "", xlim=local.xlim, ylim=local.ylim,col="blue", xaxt='n', yaxt='n')#
abline(v=1,lty=3)#
par(new=TRUE)#
plot(density(Results[,21],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,25],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="pink", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,47],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="forestgreen", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,53],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,35],na.rm=TRUE), main = "", xlab = "Beta 0",xlim=local.xlim, ylim=local.ylim,col="purple")#
text (x=.7, y =6.4, "Z.Exp",col="red")#
text (x=.7, y =6, "Z.Wei",col="forestgreen")#
text (x=1.33, y =6.25, "Exp",col="blue")#
text (x=1.5, y =6.25, "Wei",col="purple")#
text (x=0.7, y =5.5, "BZ.Exp",col="pink")#
text (x=0, y =6.25, "BZ.Wei",col="orange")#
par(new=FALSE)#
#B1#
local.xlim<-c(3.40,3.6)#
local.ylim<-c(0,46.5)#
plot(density(Results[,13],na.rm=TRUE), main = "",  ylab = "", xlab = "", xlim=local.xlim, ylim=local.ylim,col="blue", xaxt='n', yaxt='n')#
abline(v=3.5,lty=3)#
par(new=TRUE)#
plot(density(Results[,23],na.rm=TRUE), main = "", ylab = "",  xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,27],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="pink", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,37],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,55],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,49],na.rm=TRUE), main = "", xlab = "Beta 1",xlim=local.xlim, ylim=local.ylim,col="forestgreen")#
#
text (x=3.55, y =42, "Z.Exp",col="red")#
text (x=3.425, y =40, "Z.Wei",col="purple")#
text (x=3.425, y =42, "Exp",col="blue")#
text (x=3.55, y =36, "Wei",col="forestgreen")#
text (x=3.55, y =40, "BZ.Exp",col="pink")#
text (x=3.55, y =38, "BZ.Wei",col="orange")#
par(new=FALSE)#
#
#B1#
local.ylim<-c(0,20)#
local.xlim<-c(0.75,1.1)#
plot(density(Results[,39],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="forestgreen", xaxt='n', yaxt='n')#
abline(v=1,lty=3)#
par(new=TRUE)#
plot(density(Results[,63],na.rm=TRUE), main = "",  ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange", xaxt='n', yaxt='n')#
par(new=TRUE)#
plot(density(Results[,51],na.rm=TRUE), main =" ", xlab = "P",xlim=local.xlim, ylim=local.ylim,col="purple")#
text (x=1.06, y =15.2, "Z.Wei",col="purple")#
text (x=1.06, y =14.2, "BZ.Wei",col="orange")#
text (x=.78, y =18, "Wei",col="forestgreen")#
par(new=FALSE)#
#
#B1#
local.ylim<-c(0,1)#
local.xlim<-c(-8,5)#
plot(density(Results[,15],na.rm=TRUE), main = "", ylab = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
abline(v=-0.44,lty=3)#
par(new=TRUE)#
plot(density(Results[,29],na.rm=TRUE), main = "", xlab = "Gamma 0",xlim=local.xlim, ylim=local.ylim,col="pink")#
par(new=TRUE)#
plot(density(Results[,41],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple")#
par(new=TRUE)#
plot(density(Results[,57],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange")#
text (x=-4, y =.38, "Z.Exp",col="red")#
text (x=1, y =.38, "BZ.Exp",col="pink")#
text (x=1, y =.35, "BZ.Wei",col="orange")#
text (x=-4, y =0.35, "Z.Wei",col="purple")#
par(new=FALSE)#
#B1#
local.ylim<-c(0,1.25)#
local.xlim<-c(.5,6)#
plot(density(Results[,17],na.rm=TRUE), main = "", ylab = "",  xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
abline(v=1.5,lty=3)#
par(new=TRUE)#
plot(density(Results[,31],na.rm=TRUE), main = "", xlab = "Gamma 1",xlim=local.xlim, ylim=local.ylim,col="pink")#
par(new=TRUE)#
plot(density(Results[,43],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple")#
par(new=TRUE)#
plot(density(Results[,59],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange")#
text (x=2.75, y =.86, "Z.Exp",col="red")#
text (x=1, y =.86, "BZ.Exp",col="pink")#
text (x=2.75, y =.80, "Z.Wei",col="purple")#
text (x=1, y =.92, "BZ.Wei",col="orange")#
par(new=FALSE)#
#
#B1#
local.ylim<-c(0,3)#
local.xlim<-c(-2,5)#
plot(density(Results[,19],na.rm=TRUE), main = "", ylab = "",  xlab = "",xlim=local.xlim, ylim=local.ylim,col="red", xaxt='n', yaxt='n')#
abline(v=-0.5,lty=3)#
par(new=TRUE)#
plot(density(Results[,33],na.rm=TRUE), main = "", xlab = "Gamma 2",xlim=local.xlim, ylim=local.ylim,col="pink")#
par(new=TRUE)#
plot(density(Results[,45],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="purple")#
par(new=TRUE)#
plot(density(Results[,61],na.rm=TRUE), main = "", xlab = "",xlim=local.xlim, ylim=local.ylim,col="orange")#
text (x=4.1, y =.6, "Z.Exp",col="red")#
text (x=4.1, y =.65, "BZ.Exp",col="pink")#
text (x=4.1, y =.55, "Z.Wei",col="purple")#
text (x=4.1, y =.70, "BZ.Wei",col="orange")#
par(new=FALSE)
load("/Users/bomin8319/Desktop/DLFM/UNfit/UNdatafull.RData")#
attach(UNdatafull)#
library(FastGP)#
library(mvtnorm)#
library(fields)#
library(reshape)#
library(MCMCpack)#
library(expm)#
library(igraph)#
#library(devtools)#
#install_github('bomin8319/DLFM/pkg')#
library(DLFM)#
reduced <-which(dimnames(Y)[[2]] %in% c("USA", "CHN", "IND", "UKG", "FRN", "GFR", "TUR", "JPN", "ISR", "SYR", "LEB", "SUD", "IRN", "AUL", "PAK", "EGY", "AFG", "PRK", "RUS", "GRG", "UKR", "ROK", "IRQ"))#
#
#reduced <-which(dimnames(Y)[[2]] %in% c("USA", "CHN", "IND", "UKG", "FRN", "GFR", "TUR", "JPN", "ISR", "SYR", "LEB", "SUD", "IRN", "AUL", "PAK", "EGY"))#
Y = Y[, reduced, reduced]#
X = X[, reduced, reduced, 1:5]#
#
for(tp in 1:32){#
	diag(X[tp,,,2]) = 0#
	Y[tp, which(avail1[tp, ]==0),] = NA#
	Y[tp, , which(avail1[tp, ]==0)] = NA#
	diag(Y[tp,,])= NA#
}
# not existing countries -> all missing values imputed using model (biased)#
avail1 = matrix(1, 32, 23)#
avail1[1:8, c(12, 20)] =0 #North and South Korea did not joined UN voting until 1990#
avail1[1:10, 21] = 0 #GRG no voted until 1992#
avail1[1:9, 22] = 0 #RUS X variables not existed until 1991#
avail1[1:9, 23] = 0 #UKR not existed until 1991#
avail1[13:21, 9] = 0 #IRQ under sanction
for(tp in 1:32){#
	diag(X[tp,,,2]) = 0#
	Y[tp, which(avail1[tp, ]==0),] = NA#
	Y[tp, , which(avail1[tp, ]==0)] = NA#
	diag(Y[tp,,])= NA#
}
Y[1,,]
lapply(1:32, function(tp){rowMeans(Y[tp,,], na.rm = TRUE)})
hi = lapply(1:32, function(tp){rowMeans(Y[tp,,], na.rm = TRUE)})
names(hi) = 1983:2014
hi
sort(names(hi[[1]]))
sapply(1:32, function(tp){hi[[tp]][2]})
sapply(1:32, function(tp){hi[[tp]][3]})
sapply(1:32, function(tp){hi[[tp]][4]})
sapply(1:32, function(tp){hi[[tp]][5]})
sapply(1:32, function(tp){hi[[tp]][6]})
sapply(1:32, function(tp){hi[[tp]][7]})
sapply(1:32, function(tp){hi[[tp]][21]})
round(sapply(1:32, function(tp){hi[[tp]][7]}),3)
round(sapply(1:32, function(tp){hi[[tp]][8]}),3)
round(sapply(1:32, function(tp){hi[[tp]][9]}),3)
round(sapply(1:32, function(tp){hi[[tp]][10]}),3)
round(sapply(1:32, function(tp){hi[[tp]][11]}),3)
round(sapply(1:32, function(tp){hi[[tp]][12]}),3)
round(sapply(1:32, function(tp){hi[[tp]][13]}),3)
round(sapply(1:32, function(tp){hi[[tp]][14]}),3)
round(sapply(1:32, function(tp){hi[[tp]][15]}),3)
round(sapply(1:32, function(tp){hi[[tp]][16]}),3)
round(sapply(1:32, function(tp){hi[[tp]][17]}),3)
round(sapply(1:32, function(tp){hi[[tp]][18]}),3)
round(sapply(1:32, function(tp){hi[[tp]][19]}),3)
round(sapply(1:32, function(tp){hi[[tp]][20]}),3)
round(sapply(1:32, function(tp){hi[[tp]][21]}),3)
round(sapply(1:32, function(tp){hi[[tp]][22]}),3)
round(sapply(1:32, function(tp){hi[[tp]][23]}),3)
load("/Users/bomin8319/Desktop/DLFM/UNfit/DLFM_AMEN.RData")#
UN1 = UN#
load("/Users/bomin8319/Desktop/DLFM/UNfit/DLFM_Dunson1.RData")#
UN2 = UN#
load("/Users/bomin8319/Desktop/DLFM/UNfit/DLFM_Dunson2.RData")#
UN3 = UN#
load("/Users/bomin8319/Desktop/DLFM/UNfit/DLFM_UNRE.RData")#
UN = UN
attach(UN)#
library(ggplot2)#
library(MCMCpack)#
library(reshape2)#
library(gridExtra)#
library(ggrepel)#
library(RColorBrewer)#
years = c(1983:2014)#
load("/Users/bomin8319/Desktop/DLFM/UNfit/UNdatafull.RData")#
attach(UNdatafull)#
library(FastGP)#
library(mvtnorm)#
library(fields)#
library(reshape)#
library(MCMCpack)#
library(expm)#
library(igraph)#
#library(devtools)#
#install_github('bomin8319/DLFM/pkg')#
library(DLFM)#
reduced <-which(dimnames(Y)[[2]] %in% c("USA", "CHN", "IND", "UKG", "FRN", "GFR", "TUR", "JPN", "ISR", "SYR", "LEB", "SUD", "IRN", "AUL", "PAK", "EGY", "AFG", "PRK", "RUS", "GRG", "UKR", "ROK", "IRQ"))#
#
#reduced <-which(dimnames(Y)[[2]] %in% c("USA", "CHN", "IND", "UKG", "FRN", "GFR", "TUR", "JPN", "ISR", "SYR", "LEB", "SUD", "IRN", "AUL", "PAK", "EGY"))#
Y = Y[, reduced, reduced]#
X = X[, reduced, reduced, 1:5]#
#
for(tp in 1:32){#
	diag(X[tp,,,2]) = 0#
}#
# not existing countries -> all missing values imputed using model (biased)#
avail1 = matrix(1, 32, 23)#
avail1[1:8, c(12, 20)] =0 #North and South Korea did not joined UN voting until 1990#
avail1[1:10, 21] = 0 #GRG no voted until 1992#
avail1[1:9, 22] = 0 #RUS X variables not existed until 1991#
avail1[1:9, 23] = 0 #UKR not existed until 1991#
avail1[13:21, 9] = 0 #IRQ under sanction#
#
load("/Users/bomin8319/Desktop/DLFM/UNfit/clang.RData")#
rownames(clang)[36] = "GFR"#
diag(clang) = 1#
Xnew = array(NA, dim = c(32,23,23,6))#
dimnames(Xnew)[1] =dimnames(X)[1]#
dimnames(Xnew)[2] =dimnames(X)[2]#
dimnames(Xnew)[3] =dimnames(X)[3]#
dimnames(Xnew)[[4]] = c("intercept", "log(distance)", "polity", "alliance", "Trade/GDP", "language")#
Xnew[,,,1:5] = X#
order = rep(NA, 23)#
for (i in 1:23){#
	if (rownames(Y[1,,])[i] %in% rownames(clang) ) {#
order[i] = which(rownames(clang)==rownames(Y[1,,])[i])#
}#
}#
order2 = order[!is.na(order)]#
clang2 = matrix(NA, 23, 23)#
rownames(clang2) = colnames(clang2)=rownames(Y[1,,])#
clang2[-c(9, 21), -c(9, 21)] = clang[order2,order2]#
clang2[9, ] = clang2[10,]#
clang2[,9 ] = clang2[,10]#
clang2[21,] = 0#
clang2[,21]  =0#
diag(clang2)= 1#
for (t in 1:32){#
	Xnew[t,,,6] = clang2#
}
## side by side #
hi = factor(1983:2014)#
hello = list()#
hello2 = list()#
hello3 = list()#
hellonew = list()#
mean = list()#
countrynames = sort(rownames(U[[32]]))#
#
n2 = 1#
for 	(n in 1:23){#
	hello[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	mean[[n]] = matrix(NA, nrow = 0, ncol = 2)#
	for (d in 1:32){#
	hello[[n]]  = rbind(hello[[n]], cbind(UN$Degree[[d]][,n2], rep(hi[d], length(UN$Degree[[d]][,n2])), rep("AME", length(UN$Degree[[d]][,n2]))))#
	diag(Y[d,, ])= 0#
	Y[d, which(avail1[d,]==0), ] = 0#
	Y[d, , which(avail1[d,]==0)] = 0#
	mean[[n]] = rbind(mean[[n]], c(rowSums(Y[d,,], na.rm=TRUE)[n2], hi[d]))#
}#
colnames(hello[[n]]) = c("Degree", "Year", "Model")#
hello[[n]] = as.data.frame(hello[[n]])#
hello[[n]]$Year = factor(sort(as.numeric(hello[[n]]$Year)), labels = c(1983:2014))#
#
	hello2[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello2[[n]]  = rbind(hello2[[n]], cbind(UN1$Degree[[d]][,n2], rep(hi[d], length(UN1$Degree[[d]][,n2])), rep("AE", length(UN1$Degree[[d]][,n2]))))#
	}#
colnames(hello2[[n]]) = c("Degree", "Year", "Model")#
hello2[[n]] = as.data.frame(hello2[[n]])#
hello2[[n]]$Year = factor(sort(as.numeric(hello2[[n]]$Year)), labels = c(1983:2014))#
#
hello3[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello3[[n]]  = rbind(hello3[[n]], cbind(UN2$Degree[[d]][,n2], rep(hi[d], length(UN2$Degree[[d]][,n2])), rep("NO", length(UN2$Degree[[d]][,n2]))))#
	}#
colnames(hello3[[n]]) = c("Degree", "Year", "Model")#
hello3[[n]] = as.data.frame(hello3[[n]])#
hello3[[n]]$Year = factor(sort(as.numeric(hello3[[n]]$Year)), labels = c(1983:2014))#
hellonew[[n]] = as.data.frame(rbind(hello[[n]], hello2[[n]], hello3[[n]]))#
colnames(mean[[n]]) =  c("Degree", "Year")#
mean[[n]] = as.data.frame(mean[[n]])#
n2 = n2 + 1#
}#
#
countryname = (rownames(U[[32]]))#
countryname2 = (rownames(U[[32]]))#
ggplotColours <- function(n = 6, h = c(0, 360) + 15){#
  if ((diff(h) %% 360) < 1) h[2] <- h[2] - 360/n#
  hcl(h = (seq(h[1], h[2], length = n)), c = 100, l = 65)#
}#
#
countrynames = ggplotColours(23)#
p10 = list()#
n2 = 1#
for (n in 1:23){#
	hellonew[[n]]$Degree = as.numeric(as.character(hellonew[[n]]$Degree))#
p10[[n]] = ggplot(hellonew[[n]], aes(x = Year, y = Degree, colour = as.factor(Model))) + geom_boxplot(outlier.size = 0.5, position = position_dodge()) + theme_bw() + scale_colour_discrete(name = countryname[n]) + geom_line(data = mean[[n]], colour = "grey60", size = 1)#
#annotate("text", 30, 10, size = 5, label = countryname2[n], colour = countrynames[n])#
n2 = n2 + 1#
#
mname = paste0(countryname2[n], n, ".png")#
print(p10[[n]])
}
## side by side #
hi = factor(1983:2014)#
hello = list()#
hello2 = list()#
hello3 = list()#
hellonew = list()#
mean = list()#
countrynames = sort(rownames(U[[32]]))#
#
n2 = 1#
for 	(n in 1:23){#
	hello[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	mean[[n]] = matrix(NA, nrow = 0, ncol = 2)#
	for (d in 1:32){#
	hello[[n]]  = rbind(hello[[n]], cbind(UN$Degree[[d]][,n2], rep(hi[d], length(UN$Degree[[d]][,n2])), rep("AME", length(UN$Degree[[d]][,n2]))))#
	diag(Y[d,, ])= 0#
	Y[d, which(avail1[d,]==0), ] = 0#
	Y[d, , which(avail1[d,]==0)] = 0#
	mean[[n]] = rbind(mean[[n]], c(rowSums(Y[d,,], na.rm=TRUE)[n2], hi[d]))#
}#
colnames(hello[[n]]) = c("Degree", "Year", "Model")#
hello[[n]] = as.data.frame(hello[[n]])#
hello[[n]]$Year = factor(sort(as.numeric(hello[[n]]$Year)), labels = c(1983:2014))#
#
	hello2[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello2[[n]]  = rbind(hello2[[n]], cbind(UN1$Degree[[d]][,n2], rep(hi[d], length(UN1$Degree[[d]][,n2])), rep("AE", length(UN1$Degree[[d]][,n2]))))#
	}#
colnames(hello2[[n]]) = c("Degree", "Year", "Model")#
hello2[[n]] = as.data.frame(hello2[[n]])#
hello2[[n]]$Year = factor(sort(as.numeric(hello2[[n]]$Year)), labels = c(1983:2014))#
#
hello3[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello3[[n]]  = rbind(hello3[[n]], cbind(UN2$Degree[[d]][,n2], rep(hi[d], length(UN2$Degree[[d]][,n2])), rep("NO", length(UN2$Degree[[d]][,n2]))))#
	}#
colnames(hello3[[n]]) = c("Degree", "Year", "Model")#
hello3[[n]] = as.data.frame(hello3[[n]])#
hello3[[n]]$Year = factor(sort(as.numeric(hello3[[n]]$Year)), labels = c(1983:2014))#
hellonew[[n]] = as.data.frame(rbind(hello[[n]], hello2[[n]], hello3[[n]]))#
colnames(mean[[n]]) =  c("Degree", "Year")#
mean[[n]] = as.data.frame(mean[[n]])#
n2 = n2 + 1#
}#
#
countryname = (rownames(U[[32]]))#
countryname2 = (rownames(U[[32]]))#
ggplotColours <- function(n = 6, h = c(0, 360) + 15){#
  if ((diff(h) %% 360) < 1) h[2] <- h[2] - 360/n#
  hcl(h = (seq(h[1], h[2], length = n)), c = 100, l = 65)#
}#
#
countrynames = ggplotColours(23)#
p10 = list()#
n2 = 1#
for (n in 1:23){#
	hellonew[[n]]$Degree = as.numeric(as.character(hellonew[[n]]$Degree))#
p10[[n]] = ggplot(hellonew[[n]], aes(x = Year, y = Degree, colour = as.factor(Model))) + geom_boxplot(outlier.size = 0.5, position = position_dodge()) + theme_bw() + scale_colour_discrete(name = countryname[n]) + geom_line(data = mean[[n]], colour = "grey60", size = 1)#
#annotate("text", 30, 10, size = 5, label = countryname2[n], colour = countrynames[n])#
n2 = n2 + 1#
#
mname = paste0(countryname2[n], n, ".png")#
print(p10[[n]])
}
## side by side #
hi = factor(1983:2014)#
hello = list()#
hello2 = list()#
hello3 = list()#
hello4 = list()#
hellonew = list()#
mean = list()#
countrynames = sort(rownames(U[[32]]))#
#
n2 = 1#
for 	(n in 1:23){#
	hello[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	mean[[n]] = matrix(NA, nrow = 0, ncol = 2)#
	for (d in 1:32){#
	hello[[n]]  = rbind(hello[[n]], cbind(UN$Degree[[d]][,n2], rep(hi[d], length(UN$Degree[[d]][,n2])), rep("AME", length(UN$Degree[[d]][,n2]))))#
	diag(Y[d,, ])= 0#
	Y[d, which(avail1[d,]==0), ] = 0#
	Y[d, , which(avail1[d,]==0)] = 0#
	mean[[n]] = rbind(mean[[n]], c(rowSums(Y[d,,], na.rm=TRUE)[n2], hi[d]))#
}#
colnames(hello[[n]]) = c("Degree", "Year", "Model")#
hello[[n]] = as.data.frame(hello[[n]])#
hello[[n]]$Year = factor(sort(as.numeric(hello[[n]]$Year)), labels = c(1983:2014))#
#
	hello2[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello2[[n]]  = rbind(hello2[[n]], cbind(UN1$Degree[[d]][,n2], rep(hi[d], length(UN1$Degree[[d]][,n2])), rep("AE", length(UN1$Degree[[d]][,n2]))))#
	}#
colnames(hello2[[n]]) = c("Degree", "Year", "Model")#
hello2[[n]] = as.data.frame(hello2[[n]])#
hello2[[n]]$Year = factor(sort(as.numeric(hello2[[n]]$Year)), labels = c(1983:2014))#
#
hello3[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello3[[n]]  = rbind(hello3[[n]], cbind(UN2$Degree[[d]][,n2], rep(hi[d], length(UN2$Degree[[d]][,n2])), rep("NO", length(UN2$Degree[[d]][,n2]))))#
	}#
colnames(hello3[[n]]) = c("Degree", "Year", "Model")#
hello3[[n]] = as.data.frame(hello3[[n]])#
hello3[[n]]$Year = factor(sort(as.numeric(hello3[[n]]$Year)), labels = c(1983:2014))#
#
hello4[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello4[[n]]  = rbind(hello3[[n]], cbind(UN3$Degree[[d]][,n2], rep(hi[d], length(UN3$Degree[[d]][,n2])), rep("NO", length(UN3$Degree[[d]][,n2]))))#
	}#
colnames(hello4[[n]]) = c("Degree", "Year", "Model")#
hello4[[n]] = as.data.frame(hello4[[n]])#
hello4[[n]]$Year = factor(sort(as.numeric(hello4[[n]]$Year)), labels = c(1983:2014))#
#
hellonew[[n]] = as.data.frame(rbind(hello[[n]], hello2[[n]], hello3[[n]], hello4[[n]]))#
colnames(mean[[n]]) =  c("Degree", "Year")#
mean[[n]] = as.data.frame(mean[[n]])#
n2 = n2 + 1#
}#
#
countryname = (rownames(U[[32]]))#
countryname2 = (rownames(U[[32]]))#
ggplotColours <- function(n = 6, h = c(0, 360) + 15){#
  if ((diff(h) %% 360) < 1) h[2] <- h[2] - 360/n#
  hcl(h = (seq(h[1], h[2], length = n)), c = 100, l = 65)#
}#
#
countrynames = ggplotColours(23)#
p10 = list()#
n2 = 1#
for (n in 1:23){#
	hellonew[[n]]$Degree = as.numeric(as.character(hellonew[[n]]$Degree))#
p10[[n]] = ggplot(hellonew[[n]], aes(x = Year, y = Degree, colour = as.factor(Model))) + geom_boxplot(outlier.size = 0.5, position = position_dodge()) + theme_bw() + scale_colour_discrete(name = countryname[n]) + geom_line(data = mean[[n]], colour = "grey60", size = 1)#
#annotate("text", 30, 10, size = 5, label = countryname2[n], colour = countrynames[n])#
n2 = n2 + 1#
#
mname = paste0(countryname2[n], n, ".png")#
print(p10[[n]])
## side by side #
hi = factor(1983:2014)#
hello = list()#
hello2 = list()#
hello3 = list()#
hello4 = list()#
hellonew = list()#
mean = list()#
countrynames = sort(rownames(U[[32]]))#
#
n2 = 1#
for 	(n in 1:23){#
	hello[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	mean[[n]] = matrix(NA, nrow = 0, ncol = 2)#
	for (d in 1:32){#
	hello[[n]]  = rbind(hello[[n]], cbind(UN$Degree[[d]][,n2], rep(hi[d], length(UN$Degree[[d]][,n2])), rep("DAME", length(UN$Degree[[d]][,n2]))))#
	diag(Y[d,, ])= 0#
	Y[d, which(avail1[d,]==0), ] = 0#
	Y[d, , which(avail1[d,]==0)] = 0#
	mean[[n]] = rbind(mean[[n]], c(rowSums(Y[d,,], na.rm=TRUE)[n2], hi[d]))#
}#
colnames(hello[[n]]) = c("Degree", "Year", "Model")#
hello[[n]] = as.data.frame(hello[[n]])#
hello[[n]]$Year = factor(sort(as.numeric(hello[[n]]$Year)), labels = c(1983:2014))#
#
	hello2[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello2[[n]]  = rbind(hello2[[n]], cbind(UN1$Degree[[d]][,n2], rep(hi[d], length(UN1$Degree[[d]][,n2])), rep("AMEN", length(UN1$Degree[[d]][,n2]))))#
	}#
colnames(hello2[[n]]) = c("Degree", "Year", "Model")#
hello2[[n]] = as.data.frame(hello2[[n]])#
hello2[[n]]$Year = factor(sort(as.numeric(hello2[[n]]$Year)), labels = c(1983:2014))#
#
hello3[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello3[[n]]  = rbind(hello3[[n]], cbind(UN2$Degree[[d]][,n2], rep(hi[d], length(UN2$Degree[[d]][,n2])), rep("Dunson1", length(UN2$Degree[[d]][,n2]))))#
	}#
colnames(hello3[[n]]) = c("Degree", "Year", "Model")#
hello3[[n]] = as.data.frame(hello3[[n]])#
hello3[[n]]$Year = factor(sort(as.numeric(hello3[[n]]$Year)), labels = c(1983:2014))#
#
hello4[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello4[[n]]  = rbind(hello3[[n]], cbind(UN3$Degree[[d]][,n2], rep(hi[d], length(UN3$Degree[[d]][,n2])), rep("Dunson2", length(UN3$Degree[[d]][,n2]))))#
	}#
colnames(hello4[[n]]) = c("Degree", "Year", "Model")#
hello4[[n]] = as.data.frame(hello4[[n]])#
hello4[[n]]$Year = factor(sort(as.numeric(hello4[[n]]$Year)), labels = c(1983:2014))#
#
hellonew[[n]] = as.data.frame(rbind(hello[[n]], hello2[[n]], hello3[[n]], hello4[[n]]))#
colnames(mean[[n]]) =  c("Degree", "Year")#
mean[[n]] = as.data.frame(mean[[n]])#
n2 = n2 + 1#
}
## side by side #
hi = factor(1983:2014)#
hello = list()#
hello2 = list()#
hello3 = list()#
hello4 = list()#
hellonew = list()#
mean = list()#
countrynames = sort(rownames(U[[32]]))#
#
n2 = 1#
for 	(n in 1:23){#
	hello[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	mean[[n]] = matrix(NA, nrow = 0, ncol = 2)#
	for (d in 1:32){#
	hello[[n]]  = rbind(hello[[n]], cbind(UN$Degree[[d]][,n2], rep(hi[d], length(UN$Degree[[d]][,n2])), rep("DAME", length(UN$Degree[[d]][,n2]))))#
	diag(Y[d,, ])= 0#
	Y[d, which(avail1[d,]==0), ] = 0#
	Y[d, , which(avail1[d,]==0)] = 0#
	mean[[n]] = rbind(mean[[n]], c(rowSums(Y[d,,], na.rm=TRUE)[n2], hi[d]))#
}#
colnames(hello[[n]]) = c("Degree", "Year", "Model")#
hello[[n]] = as.data.frame(hello[[n]])#
hello[[n]]$Year = factor(sort(as.numeric(hello[[n]]$Year)), labels = c(1983:2014))#
#
	hello2[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello2[[n]]  = rbind(hello2[[n]], cbind(UN1$Degree[[d]][,n2], rep(hi[d], length(UN1$Degree[[d]][,n2])), rep("AMEN", length(UN1$Degree[[d]][,n2]))))#
	}#
colnames(hello2[[n]]) = c("Degree", "Year", "Model")#
hello2[[n]] = as.data.frame(hello2[[n]])#
hello2[[n]]$Year = factor(sort(as.numeric(hello2[[n]]$Year)), labels = c(1983:2014))#
#
hello3[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello3[[n]]  = rbind(hello3[[n]], cbind(UN2$Degree[[d]][,n2], rep(hi[d], length(UN2$Degree[[d]][,n2])), rep("Dunson1", length(UN2$Degree[[d]][,n2]))))#
	}#
colnames(hello3[[n]]) = c("Degree", "Year", "Model")#
hello3[[n]] = as.data.frame(hello3[[n]])#
hello3[[n]]$Year = factor(sort(as.numeric(hello3[[n]]$Year)), labels = c(1983:2014))#
#
hello4[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello4[[n]]  = rbind(hello3[[n]], cbind(UN3$Degree[[d]][,n2], rep(hi[d], length(UN3$Degree[[d]][,n2])), rep("Dunson2", length(UN3$Degree[[d]][,n2]))))#
	}#
colnames(hello4[[n]]) = c("Degree", "Year", "Model")#
hello4[[n]] = as.data.frame(hello4[[n]])#
hello4[[n]]$Year = factor(sort(as.numeric(hello4[[n]]$Year)), labels = c(1983:2014))#
#
hellonew[[n]] = as.data.frame(rbind(hello[[n]], hello2[[n]], hello3[[n]], hello4[[n]]))#
colnames(mean[[n]]) =  c("Degree", "Year")#
mean[[n]] = as.data.frame(mean[[n]])#
n2 = n2 + 1#
}
## side by side #
hi = factor(1983:2014)#
hello = list()#
hello2 = list()#
hello3 = list()#
hello4 = list()#
hellonew = list()#
mean = list()#
countrynames = sort(rownames(U[[32]]))#
#
n2 = 1#
for 	(n in 1:23){#
	hello[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	mean[[n]] = matrix(NA, nrow = 0, ncol = 2)#
	for (d in 1:32){#
	hello[[n]]  = rbind(hello[[n]], cbind(UN$Degree[[d]][,n2], rep(hi[d], length(UN$Degree[[d]][,n2])), rep("DAME", length(UN$Degree[[d]][,n2]))))#
	diag(Y[d,, ])= 0#
	Y[d, which(avail1[d,]==0), ] = 0#
	Y[d, , which(avail1[d,]==0)] = 0#
	mean[[n]] = rbind(mean[[n]], c(rowSums(Y[d,,], na.rm=TRUE)[n2], hi[d]))#
}#
colnames(hello[[n]]) = c("Degree", "Year", "Model")#
hello[[n]] = as.data.frame(hello[[n]])#
hello[[n]]$Year = factor(sort(as.numeric(hello[[n]]$Year)), labels = c(1983:2014))#
#
	hello2[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello2[[n]]  = rbind(hello2[[n]], cbind(UN1$Degree[[d]][,n2], rep(hi[d], length(UN1$Degree[[d]][,n2])), rep("AMEN", length(UN1$Degree[[d]][,n2]))))#
	}#
colnames(hello2[[n]]) = c("Degree", "Year", "Model")#
hello2[[n]] = as.data.frame(hello2[[n]])#
hello2[[n]]$Year = factor(sort(as.numeric(hello2[[n]]$Year)), labels = c(1983:2014))#
#
hello3[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello3[[n]]  = rbind(hello3[[n]], cbind(UN2$Degree[[d]][,n2], rep(hi[d], length(UN2$Degree[[d]][,n2])), rep("Dunson1", length(UN2$Degree[[d]][,n2]))))#
	}#
colnames(hello3[[n]]) = c("Degree", "Year", "Model")#
hello3[[n]] = as.data.frame(hello3[[n]])#
hello3[[n]]$Year = factor(sort(as.numeric(hello3[[n]]$Year)), labels = c(1983:2014))#
#
hello4[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello4[[n]]  = rbind(hello3[[n]], cbind(UN3$Degree[[d]][,n2], rep(hi[d], length(UN3$Degree[[d]][,n2])), rep("Dunson2", length(UN3$Degree[[d]][,n2]))))#
	}#
colnames(hello4[[n]]) = c("Degree", "Year", "Model")#
hello4[[n]] = as.data.frame(hello4[[n]])#
hello4[[n]]$Year = factor(sort(as.numeric(hello4[[n]]$Year)), labels = c(1983:2014))
}
## side by side #
hi = factor(1983:2014)#
hello = list()#
hello2 = list()#
hello3 = list()#
hello4 = list()#
hellonew = list()#
mean = list()#
countrynames = sort(rownames(U[[32]]))#
#
n2 = 1#
for 	(n in 1:23){#
	hello[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	mean[[n]] = matrix(NA, nrow = 0, ncol = 2)#
	for (d in 1:32){#
	hello[[n]]  = rbind(hello[[n]], cbind(UN$Degree[[d]][,n2], rep(hi[d], length(UN$Degree[[d]][,n2])), rep("DAME", length(UN$Degree[[d]][,n2]))))#
	diag(Y[d,, ])= 0#
	Y[d, which(avail1[d,]==0), ] = 0#
	Y[d, , which(avail1[d,]==0)] = 0#
	mean[[n]] = rbind(mean[[n]], c(rowSums(Y[d,,], na.rm=TRUE)[n2], hi[d]))#
}#
colnames(hello[[n]]) = c("Degree", "Year", "Model")#
hello[[n]] = as.data.frame(hello[[n]])#
hello[[n]]$Year = factor(sort(as.numeric(hello[[n]]$Year)), labels = c(1983:2014))#
#
	hello2[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello2[[n]]  = rbind(hello2[[n]], cbind(UN1$Degree[[d]][,n2], rep(hi[d], length(UN1$Degree[[d]][,n2])), rep("AMEN", length(UN1$Degree[[d]][,n2]))))#
	}#
colnames(hello2[[n]]) = c("Degree", "Year", "Model")#
hello2[[n]] = as.data.frame(hello2[[n]])#
hello2[[n]]$Year = factor(sort(as.numeric(hello2[[n]]$Year)), labels = c(1983:2014))#
#
hello3[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello3[[n]]  = rbind(hello3[[n]], cbind(UN2$Degree[[d]][,n2], rep(hi[d], length(UN2$Degree[[d]][,n2])), rep("Dunson1", length(UN2$Degree[[d]][,n2]))))#
	}#
colnames(hello3[[n]]) = c("Degree", "Year", "Model")#
hello3[[n]] = as.data.frame(hello3[[n]])#
hello3[[n]]$Year = factor(sort(as.numeric(hello3[[n]]$Year)), labels = c(1983:2014))#
#
hello4[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello4[[n]]  = rbind(hello4[[n]], cbind(UN3$Degree[[d]][,n2], rep(hi[d], length(UN3$Degree[[d]][,n2])), rep("Dunson2", length(UN3$Degree[[d]][,n2]))))#
	}#
colnames(hello4[[n]]) = c("Degree", "Year", "Model")#
hello4[[n]] = as.data.frame(hello4[[n]])#
hello4[[n]]$Year = factor(sort(as.numeric(hello4[[n]]$Year)), labels = c(1983:2014))#
#
hellonew[[n]] = as.data.frame(rbind(hello[[n]], hello2[[n]], hello3[[n]], hello4[[n]]))#
colnames(mean[[n]]) =  c("Degree", "Year")#
mean[[n]] = as.data.frame(mean[[n]])#
n2 = n2 + 1#
}
countryname = (rownames(U[[32]]))#
countryname2 = (rownames(U[[32]]))#
ggplotColours <- function(n = 6, h = c(0, 360) + 15){#
  if ((diff(h) %% 360) < 1) h[2] <- h[2] - 360/n#
  hcl(h = (seq(h[1], h[2], length = n)), c = 100, l = 65)#
}#
#
countrynames = ggplotColours(23)#
p10 = list()#
n2 = 1#
for (n in 1:23){#
	hellonew[[n]]$Degree = as.numeric(as.character(hellonew[[n]]$Degree))#
p10[[n]] = ggplot(hellonew[[n]], aes(x = Year, y = Degree, colour = as.factor(Model))) + geom_boxplot(outlier.size = 0.5, position = position_dodge()) + theme_bw() + scale_colour_discrete(name = countryname[n]) + geom_line(data = mean[[n]], colour = "grey60", size = 1)#
#annotate("text", 30, 10, size = 5, label = countryname2[n], colour = countrynames[n])#
n2 = n2 + 1#
#
mname = paste0(countryname2[n], n, ".png")#
print(p10[[n]])
}
UN1$kappas
UN$kappas
UN2$kappas
UN3$kappas
mname = paste0(countryname2[n], n, "4external", ".png")
mname
mname = paste0(countryname2[n], n, "fourexternal", ".png")
mname
setwd('/Users/bomin8319/Desktop/DLFM/external')#
#
#external comparison#
#
## side by side #
hi = factor(1983:2014)#
hello = list()#
hello2 = list()#
hello3 = list()#
hello4 = list()#
hellonew = list()#
mean = list()#
countrynames = sort(rownames(U[[32]]))#
#
n2 = 1#
for 	(n in 1:23){#
	hello[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	mean[[n]] = matrix(NA, nrow = 0, ncol = 2)#
	for (d in 1:32){#
	hello[[n]]  = rbind(hello[[n]], cbind(UN$Degree[[d]][,n2], rep(hi[d], length(UN$Degree[[d]][,n2])), rep("DAME", length(UN$Degree[[d]][,n2]))))#
	diag(Y[d,, ])= 0#
	Y[d, which(avail1[d,]==0), ] = 0#
	Y[d, , which(avail1[d,]==0)] = 0#
	mean[[n]] = rbind(mean[[n]], c(rowSums(Y[d,,], na.rm=TRUE)[n2], hi[d]))#
}#
colnames(hello[[n]]) = c("Degree", "Year", "Model")#
hello[[n]] = as.data.frame(hello[[n]])#
hello[[n]]$Year = factor(sort(as.numeric(hello[[n]]$Year)), labels = c(1983:2014))#
#
	hello2[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello2[[n]]  = rbind(hello2[[n]], cbind(UN1$Degree[[d]][,n2], rep(hi[d], length(UN1$Degree[[d]][,n2])), rep("AMEN", length(UN1$Degree[[d]][,n2]))))#
	}#
colnames(hello2[[n]]) = c("Degree", "Year", "Model")#
hello2[[n]] = as.data.frame(hello2[[n]])#
hello2[[n]]$Year = factor(sort(as.numeric(hello2[[n]]$Year)), labels = c(1983:2014))#
#
hello3[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello3[[n]]  = rbind(hello3[[n]], cbind(UN2$Degree[[d]][,n2], rep(hi[d], length(UN2$Degree[[d]][,n2])), rep("Dunson1", length(UN2$Degree[[d]][,n2]))))#
	}#
colnames(hello3[[n]]) = c("Degree", "Year", "Model")#
hello3[[n]] = as.data.frame(hello3[[n]])#
hello3[[n]]$Year = factor(sort(as.numeric(hello3[[n]]$Year)), labels = c(1983:2014))#
#
hello4[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello4[[n]]  = rbind(hello4[[n]], cbind(UN3$Degree[[d]][,n2], rep(hi[d], length(UN3$Degree[[d]][,n2])), rep("Dunson2", length(UN3$Degree[[d]][,n2]))))#
	}#
colnames(hello4[[n]]) = c("Degree", "Year", "Model")#
hello4[[n]] = as.data.frame(hello4[[n]])#
hello4[[n]]$Year = factor(sort(as.numeric(hello4[[n]]$Year)), labels = c(1983:2014))#
#
hellonew[[n]] = as.data.frame(rbind(hello[[n]], hello2[[n]], hello3[[n]], hello4[[n]]))#
colnames(mean[[n]]) =  c("Degree", "Year")#
mean[[n]] = as.data.frame(mean[[n]])#
n2 = n2 + 1#
}#
#
countryname = (rownames(U[[32]]))#
countryname2 = (rownames(U[[32]]))#
ggplotColours <- function(n = 6, h = c(0, 360) + 15){#
  if ((diff(h) %% 360) < 1) h[2] <- h[2] - 360/n#
  hcl(h = (seq(h[1], h[2], length = n)), c = 100, l = 65)#
}#
#
countrynames = ggplotColours(23)#
p10 = list()#
n2 = 1#
for (n in 1:23){#
	hellonew[[n]]$Degree = as.numeric(as.character(hellonew[[n]]$Degree))#
p10[[n]] = ggplot(hellonew[[n]], aes(x = Year, y = Degree, colour = as.factor(Model))) + geom_boxplot(outlier.size = 0.5, position = position_dodge()) + theme_bw() + scale_colour_discrete(name = countryname[n]) + geom_line(data = mean[[n]], colour = "grey60", size = 1)#
#annotate("text", 30, 10, size = 5, label = countryname2[n], colour = countrynames[n])#
n2 = n2 + 1#
#
mname = paste0(countryname2[n], n, "fourexternal", ".png")#
print(p10[[n]])#
ggsave(filename = mname, width = 10, height = 6)#
}
p10[[n]] = ggplot(hellonew[[n]], aes(x = Year, y = Degree, colour = as.factor(Model))) + geom_boxplot(outlier.size = 0.5, position = position_dodge()) + theme_bw() + scale_colour_discrete(name = countryname[n]) + geom_line(data = mean[[n]], colour = "grey60", size = 0.5)
n
p10[[1]]
countrynames = ggplotColours(23)#
p10 = list()#
n2 = 1#
for (n in 1:23){#
	hellonew[[n]]$Degree = as.numeric(as.character(hellonew[[n]]$Degree))#
p10[[n]] = ggplot(hellonew[[n]], aes(x = Year, y = Degree, colour = as.factor(Model))) + geom_boxplot(outlier.size = 0.5, position = position_dodge()) + theme_bw() + scale_colour_discrete(name = countryname[n]) + geom_line(data = mean[[n]], colour = "grey60", size = 0.5)#
#annotate("text", 30, 10, size = 5, label = countryname2[n], colour = countrynames[n])#
n2 = n2 + 1#
#
mname = paste0(countryname2[n], n, "fourexternal", ".png")#
print(p10[[n]])#
ggsave(filename = mname, width = 10, height = 6)#
}
n
countrynames = ggplotColours(23)#
p10 = list()#
n2 = 1#
for (n in 1:23){#
	hellonew[[n]]$Degree = as.numeric(as.character(hellonew[[n]]$Degree))#
p10[[n]] = ggplot(hellonew[[n]], aes(x = Year, y = Degree, colour = as.factor(Model))) + geom_boxplot(outlier.size = 0.5, position = position_dodge()) + theme_bw() + scale_colour_discrete(name = countryname[n]) + geom_line(data = mean[[n]], colour = "grey60", size = 0.8)#
#annotate("text", 30, 10, size = 5, label = countryname2[n], colour = countrynames[n])#
n2 = n2 + 1#
#
mname = paste0(countryname2[n], n, "four", ".png")#
print(p10[[n]])#
ggsave(filename = mname, width = 10, height = 6)#
}
## side by side #
hi = factor(1983:2014)#
hello = list()#
hello2 = list()#
hello3 = list()#
hello4 = list()#
hellonew = list()#
mean = list()#
countrynames = sort(rownames(U[[32]]))#
#
n2 = 1#
for 	(n in 1:23){#
	hello[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	mean[[n]] = matrix(NA, nrow = 0, ncol = 2)#
	for (d in 1:32){#
	hello[[n]]  = rbind(hello[[n]], cbind(UN$Degree[[d]][,n2], rep(hi[d], length(UN$Degree[[d]][,n2])), rep("DAME", length(UN$Degree[[d]][,n2]))))#
	diag(Y[d,, ])= 0#
	Y[d, which(avail1[d,]==0), ] = 0#
	Y[d, , which(avail1[d,]==0)] = 0#
	mean[[n]] = rbind(mean[[n]], c(rowSums(Y[d,,], na.rm=TRUE)[n2], hi[d]))#
}#
colnames(hello[[n]]) = c("Degree", "Year", "Model")#
hello[[n]] = as.data.frame(hello[[n]])#
hello[[n]]$Year = factor(sort(as.numeric(hello[[n]]$Year)), labels = c(1983:2014))#
#
	hello2[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello2[[n]]  = rbind(hello2[[n]], cbind(UN1$Degree[[d]][,n2], rep(hi[d], length(UN1$Degree[[d]][,n2])), rep("AMEN", length(UN1$Degree[[d]][,n2]))))#
	}#
colnames(hello2[[n]]) = c("Degree", "Year", "Model")#
hello2[[n]] = as.data.frame(hello2[[n]])#
hello2[[n]]$Year = factor(sort(as.numeric(hello2[[n]]$Year)), labels = c(1983:2014))#
#
hello3[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello3[[n]]  = rbind(hello3[[n]], cbind(UN2$Degree[[d]][,n2], rep(hi[d], length(UN2$Degree[[d]][,n2])), rep("Dunson1", length(UN2$Degree[[d]][,n2]))))#
	}#
colnames(hello3[[n]]) = c("Degree", "Year", "Model")#
hello3[[n]] = as.data.frame(hello3[[n]])#
hello3[[n]]$Year = factor(sort(as.numeric(hello3[[n]]$Year)), labels = c(1983:2014))#
#
hello4[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello4[[n]]  = rbind(hello4[[n]], cbind(UN3$Degree[[d]][,n2], rep(hi[d], length(UN3$Degree[[d]][,n2])), rep("Dunson2", length(UN3$Degree[[d]][,n2]))))#
	}#
colnames(hello4[[n]]) = c("Degree", "Year", "Model")#
hello4[[n]] = as.data.frame(hello4[[n]])#
hello4[[n]]$Year = factor(sort(as.numeric(hello4[[n]]$Year)), labels = c(1983:2014))#
#
hellonew[[n]] = as.data.frame(rbind(hello[[n]], hello2[[n]], hello3[[n]], hello4[[n]]))#
colnames(mean[[n]]) =  c("Degree", "Year")#
mean[[n]] = as.data.frame(mean[[n]])#
n2 = n2 + 1#
}#
#
countryname = (rownames(U[[32]]))#
countryname2 = (rownames(U[[32]]))#
ggplotColours <- function(n = 6, h = c(0, 360) + 15){#
  if ((diff(h) %% 360) < 1) h[2] <- h[2] - 360/n#
  hcl(h = (seq(h[1], h[2], length = n)), c = 100, l = 65)#
}#
#
countrynames = ggplotColours(23)#
p10 = list()#
n2 = 1#
for (n in 1:23){#
	hellonew[[n]]$Degree = as.numeric(as.character(hellonew[[n]]$Degree))#
p10[[n]] = ggplot(hellonew[[n]], aes(x = Year, y = Degree, colour = as.factor(Model))) + geom_boxplot(outlier.size = 0.5, position = position_dodge()) + theme_bw() + scale_colour_discrete(name = countryname[n]) + geom_line(data = mean[[n]], colour = "grey60", size = 0.8)#
#annotate("text", 30, 10, size = 5, label = countryname2[n], colour = countrynames[n])#
n2 = n2 + 1#
#
mname = paste0(countryname2[n], n, "four", ".png")#
print(p10[[n]])#
ggsave(filename = mname, width = 10, height = 6)#
}
head(hellonew)
head(hellonew[[1]])
dim(hellonew[[1]])
dim(hellonew[[n]][which(hellonew[[n]]$Model !== "Dunson1")])
dim(hellonew[[n]][which(hellonew[[n]]$Model != "Dunson1")])
dim(hellonew[[n]][-which(hellonew[[n]]$Model == "Dunson1")])
which(hellonew[[n]]$Model == "Dunson1")
dim(hellonew[[n]][-which(hellonew[[n]]$Model == "Dunson1"),])
colnames(hellonew[[n]])
## side by side #
hi = factor(1983:2014)#
hello = list()#
hello2 = list()#
hello3 = list()#
hello4 = list()#
hellonew = list()#
mean = list()#
countrynames = sort(rownames(U[[32]]))#
#
n2 = 1#
for 	(n in 1:23){#
	hello[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	mean[[n]] = matrix(NA, nrow = 0, ncol = 2)#
	for (d in 1:32){#
	hello[[n]]  = rbind(hello[[n]], cbind(UN$Degree[[d]][,n2], rep(hi[d], length(UN$Degree[[d]][,n2])), rep("DAME", length(UN$Degree[[d]][,n2]))))#
	diag(Y[d,, ])= 0#
	Y[d, which(avail1[d,]==0), ] = 0#
	Y[d, , which(avail1[d,]==0)] = 0#
	mean[[n]] = rbind(mean[[n]], c(rowSums(Y[d,,], na.rm=TRUE)[n2], hi[d]))#
}#
colnames(hello[[n]]) = c("Degree", "Year", "Model")#
hello[[n]] = as.data.frame(hello[[n]])#
hello[[n]]$Year = factor(sort(as.numeric(hello[[n]]$Year)), labels = c(1983:2014))#
#
	hello2[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello2[[n]]  = rbind(hello2[[n]], cbind(UN1$Degree[[d]][,n2], rep(hi[d], length(UN1$Degree[[d]][,n2])), rep("AMEN", length(UN1$Degree[[d]][,n2]))))#
	}#
colnames(hello2[[n]]) = c("Degree", "Year", "Model")#
hello2[[n]] = as.data.frame(hello2[[n]])#
hello2[[n]]$Year = factor(sort(as.numeric(hello2[[n]]$Year)), labels = c(1983:2014))#
#
#hello3[[n]] = matrix(NA, nrow = 0, ncol = 3)#
#	for (d in 1:32){#
#	hello3[[n]]  = rbind(hello3[[n]], cbind(UN2$Degree[[d]][,n2], rep(hi[d], length(UN2$Degree[[d]][,n2])), rep("Dunson1", length(UN2$Degree[[d]][,n2]))))#
#	}#
#colnames(hello3[[n]]) = c("Degree", "Year", "Model")#
#hello3[[n]] = as.data.frame(hello3[[n]])#
#hello3[[n]]$Year = factor(sort(as.numeric(hello3[[n]]$Year)), labels = c(1983:2014))#
#
hello4[[n]] = matrix(NA, nrow = 0, ncol = 3)#
	for (d in 1:32){#
	hello4[[n]]  = rbind(hello4[[n]], cbind(UN3$Degree[[d]][,n2], rep(hi[d], length(UN3$Degree[[d]][,n2])), rep("DLSM", length(UN3$Degree[[d]][,n2]))))#
	}#
colnames(hello4[[n]]) = c("Degree", "Year", "Model")#
hello4[[n]] = as.data.frame(hello4[[n]])#
hello4[[n]]$Year = factor(sort(as.numeric(hello4[[n]]$Year)), labels = c(1983:2014))#
#
hellonew[[n]] = as.data.frame(rbind(hello[[n]], hello2[[n]], hello4[[n]]))#
colnames(mean[[n]]) =  c("Degree", "Year")#
mean[[n]] = as.data.frame(mean[[n]])#
n2 = n2 + 1#
}#
#
countryname = (rownames(U[[32]]))#
countryname2 = (rownames(U[[32]]))#
ggplotColours <- function(n = 6, h = c(0, 360) + 15){#
  if ((diff(h) %% 360) < 1) h[2] <- h[2] - 360/n#
  hcl(h = (seq(h[1], h[2], length = n)), c = 100, l = 65)#
}#
#
countrynames = ggplotColours(23)#
p10 = list()#
n2 = 1#
for (n in 1:23){#
	hellonew[[n]]$Degree = as.numeric(as.character(hellonew[[n]]$Degree))#
p10[[n]] = ggplot(hellonew[[n]], aes(x = Year, y = Degree, colour = as.factor(Model))) + geom_boxplot(outlier.size = 0.5, position = position_dodge()) + theme_bw() + scale_colour_discrete(name = countryname[n]) + geom_line(data = mean[[n]], colour = "grey60", size = 0.8)#
#annotate("text", 30, 10, size = 5, label = countryname2[n], colour = countrynames[n])#
n2 = n2 + 1#
#
mname = paste0(countryname2[n], n, "three", ".png")#
print(p10[[n]])#
ggsave(filename = mname, width = 10, height = 6)#
}
n
head(hellonew[[n]]$Degree)
n
n = 10
n
head(hellonew[[n]]$Degree)
head(hellonew[[n]])
unique(hellonew[[n]]$Year)
mean[[n]]
library(hydroGOF)
years
hellonew[[n]][which(hellonew[[n]]$Year == years[t]), 1]
dim(hellonew[[n]])
48000/32
sapply(1:32, function(t){ sum((hellonew[[n]][which(hellonew[[n]]$Year == years[t]), 1] - mean[[n]][t, 1])^2)})
which(hellonew[[n]]$Year == years[t] & hellonew[[n]]$Model == "DAME")
sapply(1:32, function(t){ sum((hellonew[[n]][which(hellonew[[n]]$Year == years[t] & hellonew[[n]]$Model == "DAME"), 1] - mean[[n]][t, 1])^2)})
sapply(1:32, function(t){ sum((hellonew[[n]][which(hellonew[[n]]$Year == years[t] & hellonew[[n]]$Model == "DLSM"), 1] - mean[[n]][t, 1])^2)})
sapply(1:32, function(t){ sum((hellonew[[n]][which(hellonew[[n]]$Year == years[t] & hellonew[[n]]$Model == "AMEN"), 1] - mean[[n]][t, 1])^2)})
rbind(sapply(1:32, function(t){ sum((hellonew[[n]][which(hellonew[[n]]$Year == years[t] & hellonew[[n]]$Model == "DAME"), 1] - mean[[n]][t, 1])^2)}),#
sapply(1:32, function(t){ sum((hellonew[[n]][which(hellonew[[n]]$Year == years[t] & hellonew[[n]]$Model == "AMEN"), 1] - mean[[n]][t, 1])^2)}),#
sapply(1:32, function(t){ sum((hellonew[[n]][which(hellonew[[n]]$Year == years[t] & hellonew[[n]]$Model == "DLSM"), 1] - mean[[n]][t, 1])^2)}))
rowSums(#
rbind(sapply(1:32, function(t){ sum((hellonew[[n]][which(hellonew[[n]]$Year == years[t] & hellonew[[n]]$Model == "DAME"), 1] - mean[[n]][t, 1])^2)}),#
sapply(1:32, function(t){ sum((hellonew[[n]][which(hellonew[[n]]$Year == years[t] & hellonew[[n]]$Model == "AMEN"), 1] - mean[[n]][t, 1])^2)}),#
sapply(1:32, function(t){ sum((hellonew[[n]][which(hellonew[[n]]$Year == years[t] & hellonew[[n]]$Model == "DLSM"), 1] - mean[[n]][t, 1])^2)}))#
)
unique(hellonew[[n]]$Model)
countrynames
countrynames = ggplotColours(23)#
p10 = list()#
n2 = 1#
for (n in 1:23){#
	hellonew[[n]]$Degree = as.numeric(as.character(hellonew[[n]]$Degree))#
p10[[n]] = ggplot(hellonew[[n]], aes(x = Year, y = Degree, colour = as.factor(Model))) + geom_boxplot(outlier.size = 0.5, position = position_dodge()) + theme_bw() + scale_colour_discrete(name = countryname[n]) + geom_line(data = mean[[n]], colour = "grey60", size = 0.8)#
#annotate("text", 30, 10, size = 5, label = countryname2[n], colour = countrynames[n])#
print(countryname2[n])#
print(rowSums(#
rbind(sapply(1:32, function(t){ sum((hellonew[[n]][which(hellonew[[n]]$Year == years[t] & hellonew[[n]]$Model == "DAME"), 1] - mean[[n]][t, 1])^2)}),#
sapply(1:32, function(t){ sum((hellonew[[n]][which(hellonew[[n]]$Year == years[t] & hellonew[[n]]$Model == "AMEN"), 1] - mean[[n]][t, 1])^2)}),#
sapply(1:32, function(t){ sum((hellonew[[n]][which(hellonew[[n]]$Year == years[t] & hellonew[[n]]$Model == "DLSM"), 1] - mean[[n]][t, 1])^2)}))#
))#
#
n2 = n2 + 1#
#
mname = paste0(countryname2[n], n, "three", ".png")#
print(p10[[n]])
}
mean
sapply(1:32, function(t){ sum((hellonew[[n]][which(hellonew[[n]]$Year == years[t] & hellonew[[n]]$Model == "DAME"), 1] - mean[[n]][t, 1])^2)})
countrynames = ggplotColours(23)#
p10 = list()#
n2 = 1#
MSE = list()#
for (n in 1:23){#
	hellonew[[n]]$Degree = as.numeric(as.character(hellonew[[n]]$Degree))#
p10[[n]] = ggplot(hellonew[[n]], aes(x = Year, y = Degree, colour = as.factor(Model))) + geom_boxplot(outlier.size = 0.5, position = position_dodge()) + theme_bw() + scale_colour_discrete(name = countryname[n]) + geom_line(data = mean[[n]], colour = "grey60", size = 0.8)#
#annotate("text", 30, 10, size = 5, label = countryname2[n], colour = countrynames[n])#
print(countryname2[n])#
MSE[[n]] = rowSums(#
rbind(sapply(1:32, function(t){ mean((hellonew[[n]][which(hellonew[[n]]$Year == years[t] & hellonew[[n]]$Model == "DAME"), 1] - mean[[n]][t, 1])^2)}),#
sapply(1:32, function(t){ mean((hellonew[[n]][which(hellonew[[n]]$Year == years[t] & hellonew[[n]]$Model == "AMEN"), 1] - mean[[n]][t, 1])^2)}),#
sapply(1:32, function(t){ mean((hellonew[[n]][which(hellonew[[n]]$Year == years[t] & hellonew[[n]]$Model == "DLSM"), 1] - mean[[n]][t, 1])^2)}))#
)#
print(MSE[[n]])#
n2 = n2 + 1#
#
mname = paste0(countryname2[n], n, "three", ".png")#
print(p10[[n]])#
ggsave(filename = mname, width = 10, height = 6)#
}
MSE
matrix(unlist(MSE))
matrix(unlist(MSE), ncol=3, byrow = TRUE)
MSE[[1]]
colSums(matrix(unlist(MSE), ncol=3, byrow = TRUE))
MSEmat = matrix(unlist(MSE), ncol=3, byrow = TRUE)
colnames(MSEmat) = c("DAME", "AMEN", "DLSM")
MSEmat
colSums(MSEmat)
